---
title: SQL Server のアップグレード データベース実験アシスタントの概要します。
description: Database 実験 Assistant の概要します。
ms.custom: ''
ms.date: 10/22/2018
ms.prod: sql
ms.prod_service: dea
ms.suite: sql
ms.technology: dea
ms.tgt_pltfrm: ''
ms.topic: conceptual
author: HJToland3
ms.author: ajaykar
ms.reviewer: douglasl
manager: craigg
ms.openlocfilehash: 7630aee7ab39f98f372af7c33f277e7272042f43
ms.sourcegitcommit: 8d6fb6bbe3491925909b83103c409effa006df88
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/22/2019
ms.locfileid: "59963278"
---
# <a name="get-started-with-database-experimentation-assistant"></a>Database 実験 Assistant の概要します。

データベース実験アシスタント (DEA) は、A、B は、アップグレード、新しいインデックスなど、SQL Server 環境での変更のソリューションをテストします。 DEA を使用して、新しい環境で現在の環境) の「移行元サーバー上ワークロードを実行する方法を評価するのに役立ちます。 DEA A を実行している手順を説明します。 B は 3 つの手順を実行してテストします。 

- キャプチャ
- 再生
- 分析

この記事では、次の手順について説明します。

## <a name="capture"></a>キャプチャ

SQL サーバー A の最初のステップ/移行元サーバー上のトレースをキャプチャするには B をテストします。 通常、移行元サーバーは、実稼働サーバーです。 トレース ファイルは、タイムスタンプを含む、そのサーバーの全体のクエリ ワークロードをキャプチャします。 後で、このトレースは分析のため、対象サーバーで再生します。 分析レポートは、2 つのターゲット サーバー間で、ワークロードのパフォーマンスの差異に insights を提供します。

注意点 :

- トレースのキャプチャを開始する前に、元のトレースをキャプチャしているデータベースをバックアップすることを確認します。
- DEA ユーザーは、Windows 認証を使用して、データベースに接続するように構成する必要があります。
- SQL Server のサービス アカウントには、ソース トレース ファイルのパスへのアクセスが必要です。

移行元サーバーでトレースをキャプチャします。

1. DEA に移動**すべてキャプチャ**を左側のメニューでカメラ アイコンを選択します。

   ![左側のナビゲーション メニュー](./media/database-experimentation-assistant-get-started/dea-get-started-leftnav.png)

1. 入力するか、次の情報を選択します。

   - **トレース名**:作成して、新しいトレース ファイルのファイル名。 トレース名、ロール オーバー ファイルの名前付け規則、CaptureName などを避ける\_NNN します。
   - **期間**:キャプチャの期間です。
   - **SQL Server インスタンス名**:SQL Server インスタンスは、トレースをキャプチャします。
   - **データベース名**:SQL Server を実行しているコンピューター上のデータベースの名前のトレースをキャプチャします。 空白の場合、トレースは、サーバー上のすべてのデータベースからキャプチャされます。
   - **SQL Server マシンでソース トレース ファイルを格納するパス**:トレース ファイルを保存するフォルダーのパス。

1. ターゲット データベースがバックアップになっていることを確認します。 次に、データベースのチェック ボックスを選択します。
1. 選択**開始**キャプチャを開始します。

開始時刻、期間、および残り時間など、キャプチャの進行状況を表示することができます。 開始することもできます、新しいキャプチャこのキャプチャ完了するまでの間にします。 キャプチャが完了したら、出力トレース ファイルを使用して 2 番目のフェーズを開始する: ターゲット サーバー上のトレース ファイルを再生します。

トレースのキャプチャに関する一般的な質問は、次を参照してください。、[よく寄せられる質問をキャプチャ](database-experimentation-assistant-capture-trace.md#frequently-asked-questions-about-trace-capture)します。

## <a name="replay"></a>再生

SQL サーバー A の 2 番目の手順/対象サーバーにキャプチャされたトレース ファイルの再生が B をテストします。 次に、分析の再生から広範なトレースを収集します。 

2 つの対象サーバー上のトレース ファイルの再生: 移行元サーバー (ターゲット 1) を模倣したものと、提案された変更 (ターゲット 2) を模倣したものです。 ターゲットの 1 と 2 のターゲットのハードウェア構成は、SQL Server は、提案された変更のパフォーマンスに与える影響を正確に分析できるように、できるだけ近いことがあります。

注意点 :

- 再生を実行するには、Distributed Replay (DReplay) トレースの実行に、マシンを設定する必要があります。 詳細については、次を参照してください。[分散再生コント ローラーとクライアントのセットアップ](https://blogs.msdn.microsoft.com/datamigration/distributed-replay-controller-and-client-setup/)します。
- 移行元サーバーからバックアップを使用して、対象サーバーでデータベースを復元することを確認します。
- クエリの SQL Server でキャッシュと評価の結果に影響を与えることができます。 評価の結果の一貫性を向上させるために、サービス アプリケーション SQL Server (MSSQLSERVER) サービスを再起動することお勧めしましています。

トレース ファイルの再生。

1. DEA に移動するのには、左側のメニューで、再生アイコンを選択します。**すべてリプレイ**します。 いずれか、表示されない場合、セッション中に実行される過去のリプレイの一覧。 新しい再生を開始する次のように選択します。**新しい再生**します。

1. 入力するか、次の情報を選択します。

   - **再生名前**:トレース再生のファイル名。
   - **コント ローラー マシン名**:分散再生コント ローラー コンピューターの名前。
   - **コント ローラーでソース トレース ファイルのパスを**:ソース トレース ファイルからのファイル パス[キャプチャ](#capture)します。
   - **SQL Server インスタンス名**:ソース トレースを再生する SQL Server インスタンスの名前。
   - **SQL Server マシンでのターゲットのトレース ファイルを格納するパス**:結果として得られる再生トレース ファイルのフォルダーのパス。

1. 最初の手順からバックアップを復元する チェック ボックスを選択します。

1. 選択**開始**再生を開始します。 

再生の状態を表示することができます。 対象サーバーの両方でソースのトレースを再生すると後、は、分析レポートを生成する準備ができました。

再生に関する一般的な質問は、次を参照してください。、[よく寄せられる質問を再生](database-experimentation-assistant-replay-trace.md#frequently-asked-questions-about-trace-replay)します。

## <a name="analysis"></a>分析

最後の手順では、トレースの再生を使用して、分析レポートを生成します。 分析レポートは、提案された変更のパフォーマンスに与える影響に関する洞察を得るのに役立ちます。

注意点 :

- 1 つまたは複数のコンポーネントが不足している場合は、新しい分析レポート (インターネット接続が必要) を生成しようとするとダウンロードのリンクを含むの前提条件ページが表示されます。
- ツールの以前のバージョンで生成されたレポートを表示するには、最初にスキーマを更新する必要があります。

分析レポートを生成するには。

1. 左側のメニューに移動**分析レポート**します。 レポート データベースを格納する SQL Server を実行しているコンピューターに接続します。 サーバーのすべてのレポートの一覧が表示されます。 新しいレポートを作成するには、次のように選択します。**新しいレポート**します。

1. 入力するか、レポートを生成するために必要な情報を選択します。

   - **レポート名**:作成する分析レポートの名前。
   - **ターゲット 1 の SQL Server のトレース**:ターゲットの 1 で再生することから、トレース ファイルのパス。
   - **2 ターゲットの SQL Server のトレース**:ターゲット 2 で再生することから、トレース ファイルのパス。

1. 選択**開始**レポートを生成します。 一覧の先頭に新しいレポートが表示されます。 レポートの隣のアイコンでは、レポートが生成されたときに緑色のチェック マークになります。

ここで、A によって提供される洞察を得るための分析レポートを表示]、[B をテストします。

分析レポートに関する一般的な質問は、次を参照してください。、[分析に関する FAQ](database-experimentation-assistant-create-report.md#frequently-asked-questions-about-analysis-reports)します。

### <a name="analysis-report"></a>分析レポート

レポートの最初のページで、実験が実行された対象サーバーのバージョンとビルドの情報が表示されます。 しきい値を使用して、秘密度や、A の許容範囲を調整できます/B テスト分析します。 既定では、しきい値が 5% に設定されます。 5% 以上がパフォーマンスが向上として分類された**向上**します。 さまざまなパフォーマンスのしきい値を使用して、レポートを評価するドロップダウン メニューでオプションを選択します。

![しきい値](https://msdnshared.blob.core.windows.net/media/2017/03/threshold.jpg)

2 つの円グラフでは、ワークロードの 2 つのターゲット サーバー間の差のパフォーマンスに与える影響について説明します。 左側のグラフは、実行回数に基づきます。 右側のグラフは、個別のクエリに基づきます。 5 つの可能なカテゴリがあります。

- **改善**:統計的には、クエリは、ターゲット 1 よりも 2 をターゲットに優れた実行されました。
- **低下**:統計的には、クエリを実行ターゲット 1 よりも 2 をターゲットに悪化します。
- **同じ**:クエリのターゲットの 1 と 2 をターゲットの間の統計の違いはありません。
- **評価できません**:統計分析のクエリのサンプルのサイズが小さすぎます。 A/、B がテストの分析、DEA 少なくとも 30 件の実行を各ターゲット上に同じクエリが必要です。
- **Error**: クエリをターゲットの 1 つに少なくとも 1 回エラーが発生しました。

![円グラフ](./media/database-experimentation-assistant-get-started/dea-get-started-piechart.png)

特定のカテゴリにドリル ダウンなどのパフォーマンス メトリックを取得して、スライスを選択、**を評価できません**円グラフのスライスします。

パフォーマンスのドリルダウン ページでは、そのカテゴリ内のクエリのリスト カテゴリの表示を変更します。 **エラー**ページが 3 つのタブ。

- **新しいエラー**:ターゲットの 1 ではなくターゲット 2 で表示されるエラー。
- **既存のエラー**:ターゲットの 1 と 2 をターゲットの両方に表示されたエラー。
- **エラーを解決**:ターゲット 2 ではなくターゲット 1 上に表示されるエラー。

   ![[エラー] ページ](./media/database-experimentation-assistant-get-started/dea-get-started-errorpage.png)

移動するクエリを選択、 **Comparison Summary**そのクエリのページ。

**比較概要**ページには、そのクエリの概要統計情報が表示されます。 概要には、実行、平均実行時間、平均 CPU、読み取り/書き込みの平均およびエラーの数の数が含まれています。

![要約統計量](./media/database-experimentation-assistant-get-started/dea-get-started-summarystats.png)

クエリが、クエリのエラーの場合、**エラー情報** タブには、エラーに関する詳細情報が表示されます。 **クエリ計画情報** タブには、ターゲットの 1 と 2 をターゲットにクエリに使用されるクエリ プランに関する情報が表示されます。

![クエリ プラン](./media/database-experimentation-assistant-get-started/dea-get-started-queryplan.png)

分析レポートのいずれかのページを選択、**印刷**ボタン上に表示されているすべてのものを印刷する権限。

## <a name="next-steps"></a>次のステップ

- サーバーで発生するイベントのログを含むトレース ファイルを生成する方法については、次を参照してください。[トレースをキャプチャ](database-experimentation-assistant-capture-trace.md)します。

- DEA とデモンストレーションを 19 分については、次のビデオをご覧ください。

  > [!VIDEO https://channel9.msdn.com/Shows/Data-Exposed/Introducing-the-Database-Experimentation-Assistant/player]
