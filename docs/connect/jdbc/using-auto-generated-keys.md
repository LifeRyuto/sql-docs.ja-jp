---
title: Auto を使用して生成されたキー |Microsoft Docs
ms.custom: ''
ms.date: 07/11/2018
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
ms.assetid: 55a062c7-45ce-40e3-9a6f-4a0f4da4e2a6
author: MightyPen
ms.author: genemi
manager: jroth
ms.openlocfilehash: 4d45e8966ffb57ba10ac96967cfbc87d820e7085
ms.sourcegitcommit: ad2e98972a0e739c0fd2038ef4a030265f0ee788
ms.translationtype: MTE75
ms.contentlocale: ja-JP
ms.lasthandoff: 06/07/2019
ms.locfileid: "66790023"
---
# <a name="using-auto-generated-keys"></a>自動生成キーの使用

[!INCLUDE[Driver_JDBC_Download](../../includes/driver_jdbc_download.md)]

[!INCLUDE[jdbcNoVersion](../../includes/jdbcnoversion_md.md)] では、自動的に生成された行識別子を取得する JDBC 3.0 API がオプションでサポートされます。 この機能の主な重要性は、クエリ、およびサーバーに対する 2 回目のラウンドトリップを要求することなく、データベース テーブルを更新するアプリケーションで IDENTITY 値を利用できることです。

[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] では識別子の擬似列をサポートしていないため、自動生成キー機能を使用する必要のある更新は、IDENTITY 列を含むテーブルに対して実行する必要があります。 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] で許可されるのは 1 つのテーブルにつき 1 つの IDENTITY 列だけです。 [SQLServerStatement](../../connect/jdbc/reference/sqlserverstatement-class.md) クラスの [getGeneratedKeys](../../connect/jdbc/reference/getgeneratedkeys-method-sqlserverstatement.md) メソッドによって返される結果セットは 1 列だけで構成され、返される列名は GENERATED_KEYS です。 生成されたキーが IDENTITY 列のないテーブルで要求された場合、JDBC ドライバーは null の結果セットを返します。

例として、[!INCLUDE[ssSampleDBnormal](../../includes/sssampledbnormal_md.md)] サンプル データベースで次のテーブルを作成します。

```sql
CREATE TABLE TestTable
   (Col1 int IDENTITY,
    Col2 varchar(50),
    Col3 int);  
```

次の例は、[!INCLUDE[ssSampleDBnormal](../../includes/sssampledbnormal_md.md)] サンプル データベースに対して開いている接続を関数に渡して、テーブルにデータを追加する SQL ステートメントを作成および実行し、IDENTITY 列の値を出力します。

[!code[JDBC#UsingAutoGeneratedKeys1](../../connect/jdbc/codesnippet/Java/using-auto-generated-keys_1.java)]

## <a name="see-also"></a>参照

[JDBC ドライバーでのステートメントの使用](../../connect/jdbc/using-statements-with-the-jdbc-driver.md)
