---
title: 位置指定更新および削除ステートメントの実行 |マイクロソフトドキュメント
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- positioned deletes [ODBC]
- cursor library [ODBC], positioned update or delete
- positioned updates [ODBC]
- ODBC cursor library [ODBC], positioned update or delete
ms.assetid: 1d64f309-2a6e-4ad1-a6b5-e81145549c56
author: David-Engel
ms.author: v-daenge
ms.openlocfilehash: 96a1aa891ef8ba26c6c239cf35e62a8f36018e65
ms.sourcegitcommit: ce94c2ad7a50945481172782c270b5b0206e61de
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/14/2020
ms.locfileid: "81307003"
---
# <a name="executing-positioned-update-and-delete-statements"></a>位置指定更新と Delete ステートメントの実行
> [!IMPORTANT]  
>  この機能は、今後のバージョンの Windows で削除される予定です。 新しい開発作業でこの機能を使用することは避け、現在この機能を使用しているアプリケーションを変更する予定です。 マイクロソフトでは、ドライバーのカーソル機能を使用することをお勧めします。  
  
 アプリケーションが**SQLFetchScroll**を使用してデータのブロックをフェッチした後、ブロック内のデータを更新または削除できます。 位置指定更新または位置指定削除を実行するには、アプリケーション:  
  
1.  **SQLSetPos**を呼び出して、更新または削除する行にカーソルを置きます。  
  
2.  次の構文を使用して、位置指定更新または削除ステートメントを構築します。  
  
     **テーブル***名を*更新  
  
     **SET** *列識別子***=**{*式*&#124; **NULL**}  
  
     [**,***列識別子***=**{*式*&#124; **NULL**} ]  
  
     **カーソル名の現在***cursor-name*  
  
     テーブル名**から削除***する-***現在の***カーソル名*  
  
     位置指定更新ステートメントで**SET**句を作成する最も簡単な方法は、更新する各列のパラメーター マーカーを使用し **、SQLBindParameter**を使用して、更新する行の行セット バッファーにこれらをバインドすることです。 この場合、パラメーターの C データ型は行セット バッファーの C データ型と同じになります。  
  
3.  位置指定更新ステートメントを実行する場合は、現在の行の行セット バッファーを更新します。 位置指定更新ステートメントが正常に実行されると、カーソル ライブラリは現在の行の各列の値をキャッシュにコピーします。  
  
    > [!CAUTION]  
    >  アプリケーションが位置指定更新ステートメントを実行する前に行セット バッファーを正しく更新しない場合、キャッシュ内のデータは、ステートメントの実行後に正しくありません。  
  
4.  カーソルに関連付けられたステートメントとは異なるステートメントを使用して、位置指定更新ステートメントまたは位置指定削除ステートメントを実行します。  
  
    > [!CAUTION]  
    >  現在の行を識別するためにカーソル ライブラリによって作成された**WHERE**句は、行の識別、別の行の識別、または複数行の識別に失敗する可能性があります。 詳細については、「[検索ステートメントの作成](../../../odbc/reference/appendixes/constructing-searched-statements.md)」を参照してください。  
  
 すべての位置指定更新および削除ステートメントには、カーソル名が必要です。 カーソル名を指定するために、アプリケーションはカーソルをオープンする前に**SQLSetCursorName**を呼び出します。 ドライバーによって生成されたカーソル名を使用するには、アプリケーションは、カーソルが開かれた後**に SQLGetCursorName**を呼び出します。  
  
 カーソル ライブラリが位置指定更新または削除ステートメントを実行した後、カーソル ライブラリによって保持される状態配列、行セット バッファー、およびキャッシュには、次の表に示す値が含まれます。  
  
|使用されるステートメント|行の状態配列の値|の値<br /><br /> 行セット バッファー|の値<br /><br /> キャッシュ バッファ|  
|--------------------|-------------------------------|----------------------------------|---------------------------------|  
|位置指定更新を行う|SQL_ROW_UPDATED|新しい値[1]|新しい値[1]|  
|位置指定削除|SQL_ROW_DELETED|古い値|古い値|  
  
 [1] アプリケーションは、位置指定更新ステートメントを実行する前に、行セット バッファーの値を更新する必要があります。位置指定更新ステートメントを実行すると、カーソル ライブラリは行セット バッファーの値をキャッシュにコピーします。
