---
title: 接続遷移 |マイクロソフトドキュメント
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- transitioning states [ODBC], connection
- connection transitions [ODBC]
- state transitions [ODBC], connection
ms.assetid: 6b6e1a47-4a52-41c8-bb9e-7ddeae09913e
author: David-Engel
ms.author: v-daenge
ms.openlocfilehash: 225f8517a78f8e9d4d765163649da174d72e490c
ms.sourcegitcommit: ce94c2ad7a50945481172782c270b5b0206e61de
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/14/2020
ms.locfileid: "81284772"
---
# <a name="connection-transitions"></a>接続の遷移
ODBC 接続の状態は次のとおりです。  
  
|State|説明|  
|-----------|-----------------|  
|C0|未割り当て環境、未割り当て接続|  
|C1|割り当て済み環境、未割り当て接続|  
|C2|割り当て済み環境、割り当て済み接続|  
|C3|接続機能にはデータが必要|  
|C4|接続接続|  
|C5|接続接続、割り当て済みステートメント|  
|C6|接続された接続、トランザクションが進行中です。 接続にステートメントが割り振られていない状態 C6 の接続が可能です。 たとえば、接続が手動コミット モードで、状態 C4 であるとします。 ステートメントが割り振られ、実行されて (トランザクションが開始された)、その後に解放された場合、トランザクションはアクティブなままですが、接続上にステートメントはありません。|  
  
 次の表は、各 ODBC 関数が接続状態に与える影響を示しています。  
  
## <a name="sqlallochandle"></a>ハンドル  
  
|C0<br /><br /> 羨望なし。|C1 未割り当て|C2<br /><br /> Allocated|C3<br /><br /> 必要なデータ|C4<br /><br /> 接続中|C5<br /><br /> ステートメント|C6<br /><br /> トランザクション|  
|--------------------|--------------------|----------------------|----------------------|----------------------|----------------------|------------------------|  
|C1[1]|--[5]|--[5]|--[5]|--[5]|--[5]|--[5]|  
|(IH)[2]|C2|--[5]|--[5]|--[5]|--[5]|--[5]|  
|(IH)[3]|(IH)|(08003)|(08003)|C5|--[5]|--[5]|  
|(IH)[4]|(IH)|(08003)|(08003)|--[5]|--[5]|--[5]|  
  
 [1] この行は *、HandleType*がSQL_HANDLE_ENVされたときの遷移を示しています。  
  
 [2] この行は *、HandleType*がSQL_HANDLE_DBCされたときの遷移を示しています。  
  
 [3] この行は *、HandleType*がSQL_HANDLE_STMTされたときの遷移を示しています。  
  
 [4] この行は *、HandleType*がSQL_HANDLE_DESCされたときの遷移を示しています。  
  
 有効なハンドルを指す**SQLAllocHandle**を呼び出すと、そのハンドルの以前の内容に関係なくハンドルが上書きされ、ODBC ドライバーに問題が発生する可能性があります。 *OutputHandlePtr* 再割り当て前にハンドルを解放するために SQLFreeHandle を呼び出さずに*\*、OutputHandlePtr*に定義された同じアプリケーション変数で**SQLAllocHandle**を 2 回呼び出すことは、ODBC アプリケーション プログラミングが正しくありません。 **SQLFreeHandle** このような方法で ODBC ハンドルを上書きすると、ODBC ドライバー側で一貫性のない動作やエラーが発生する可能性があります。  
  
## <a name="sqlbrowseconnect"></a>SQLBrowseConnect  
  
|C0<br /><br /> 羨望なし。|C1<br /><br /> 未割り当て|C2<br /><br /> Allocated|C3<br /><br /> 必要なデータ|C4<br /><br /> 接続中|C5<br /><br /> ステートメント|C6<br /><br /> トランザクション|  
|--------------------|------------------------|----------------------|----------------------|----------------------|----------------------|------------------------|  
|(IH)|(IH)|C3 [d] C4 [s]|-- [d] C2 [e] C4 [s]|(08002)|(08002)|(08002)|  
  
## <a name="sqlclosecursor"></a>SQLCloseCursor  
  
|C0<br /><br /> 羨望なし。|C1<br /><br /> 未割り当て|C2<br /><br /> Allocated|C3<br /><br /> 必要なデータ|C4<br /><br /> 接続中|C5<br /><br /> ステートメント|C6<br /><br /> トランザクション|  
|--------------------|------------------------|----------------------|----------------------|----------------------|----------------------|------------------------|  
|(IH)|(IH)|(IH)|(IH)|(IH)|--|--[1] C5[2]|  
  
 接続が手動コミット モードであった。  
  
 [2] 接続が自動コミット モードでした。  
  
## <a name="sqlcolumnprivileges-sqlcolumns-sqlforeignkeys-sqlgettypeinfo-sqlprimarykeys-sqlprocedurecolumns-sqlprocedures-sqlspecialcolumns-sqlstatistics-sqltableprivileges-and-sqltables"></a>SQL 列特権、SQL 列、SQL 外部キー、SQLGetTypeInfo、SQL プライマリ キー、SQL プロシージャ列、SQL プロシージャ、SQL 特殊列、SQL 統計、SQL テーブル特権、および SQL テーブル  
  
|C0<br /><br /> 羨望なし。|C1<br /><br /> 未割り当て|C2<br /><br /> Allocated|C3<br /><br /> 必要なデータ|C4<br /><br /> 接続中|C5<br /><br /> ステートメント|C6<br /><br /> トランザクション|  
|--------------------|------------------------|----------------------|----------------------|----------------------|----------------------|------------------------|  
|(IH)|(IH)|(IH)|(IH)|(IH)|--[1] C6[2]|--|  
  
 接続が自動コミット モードであるか、データ ソースがトランザクションを開始しませんでした。  
  
 接続が手動コミット モードで、データ ソースがトランザクションを開始しました。  
  
## <a name="sqlconnect"></a>SQLConnect  
  
|C0<br /><br /> 羨望なし。|C1<br /><br /> 未割り当て|C2<br /><br /> Allocated|C3<br /><br /> 必要なデータ|C4<br /><br /> 接続中|C5<br /><br /> ステートメント|C6<br /><br /> トランザクション|  
|--------------------|------------------------|----------------------|----------------------|----------------------|----------------------|------------------------|  
|(IH)|(IH)|C4|(08002)|(08002)|(08002)|(08002)|  
  
## <a name="sqlcopydesc-sqlgetdescfield-sqlgetdescrec-sqlsetdescfield-and-sqlsetdescrec"></a>SQLCopyDesc、SQLGetDescフィールド、SQLGetDescRec、SQLセットデスフィールド、および SQL セットデズレック  
  
|C0<br /><br /> 羨望なし。|C1<br /><br /> 未割り当て|C2<br /><br /> Allocated|C3<br /><br /> 必要なデータ|C4<br /><br /> 接続中|C5<br /><br /> ステートメント|C6<br /><br /> トランザクション|  
|--------------------|------------------------|----------------------|----------------------|----------------------|----------------------|------------------------|  
|(IH)|(IH)|(IH)|(IH)|--[1]|--|--|  
  
 [1] この状態では、アプリケーションで使用できる記述子は明示的に割り当てられます。  
  
## <a name="sqldatasources-and-sqldrivers"></a>SQL データソースと SQL ドライバー  
  
|C0<br /><br /> 羨望なし。|C1<br /><br /> 未割り当て|C2<br /><br /> Allocated|C3<br /><br /> 必要なデータ|C4<br /><br /> 接続中|C5<br /><br /> ステートメント|C6<br /><br /> トランザクション|  
|--------------------|------------------------|----------------------|----------------------|----------------------|----------------------|------------------------|  
|(IH)|--|--|--|--|--|--|  
  
## <a name="sqldisconnect"></a>接続解除  
  
|C0<br /><br /> 羨望なし。|C1<br /><br /> 未割り当て|C2<br /><br /> Allocated|C3<br /><br /> 必要なデータ|C4<br /><br /> 接続中|C5<br /><br /> ステートメント|C6<br /><br /> トランザクション|  
|--------------------|------------------------|----------------------|----------------------|----------------------|----------------------|------------------------|  
|(IH)|(IH)|(08003)|C2|C2|C2|25000|  
  
## <a name="sqldriverconnect"></a>SQLDriverConnect  
  
|C0<br /><br /> 羨望なし。|C1<br /><br /> 未割り当て|C2<br /><br /> Allocated|C3<br /><br /> 必要なデータ|C4<br /><br /> 接続中|C5<br /><br /> ステートメント|C6<br /><br /> トランザクション|  
|--------------------|------------------------|----------------------|----------------------|----------------------|----------------------|------------------------|  
|(IH)|(IH)|C4 s -- n[f]|(08002)|(08002)|(08002)|(08002)|  
  
## <a name="sqlendtran"></a>SQLEndTran  
  
|C0<br /><br /> 羨望なし。|C1<br /><br /> 未割り当て|C2<br /><br /> Allocated|C3<br /><br /> 必要なデータ|C4<br /><br /> 接続中|C5<br /><br /> ステートメント|C6<br /><br /> トランザクション|  
|--------------------|------------------------|----------------------|----------------------|----------------------|----------------------|------------------------|  
|(IH)[1]|--[3]|--[3]|--[3]|--|--|--[4] または [5]、[6]、および [8]) C4[5]と[7]C5[5]、[6]、および[9]。|  
|(IH)[2]|(IH)|(08003)|(08003)|--|--|C5|  
  
 [1] この行は *、HandleType*がSQL_HANDLE_ENVされたときの遷移を示しています。  
  
 [2] この行は *、HandleType*がSQL_HANDLE_DBCされたときの遷移を示しています。  
  
 接続が接続状態ではないため、トランザクションの影響を受けません。  
  
 [4] 接続でコミットまたはロールバックが失敗しました。 この場合、関数はSQL_ERRORを返します。  
  
 [5] 接続でコミットまたはロールバックに成功しました。 この関数は、別の接続でコミットまたはロールバックが失敗した場合にSQL_ERRORを返すか、すべての接続でコミットまたはロールバックが成功した場合に、関数がSQL_SUCCESSを返します。  
  
 [6] 接続に少なくとも 1 つのステートメントが割り当てられていた。  
  
 [7] 接続に割り当てられたステートメントが存在しない。  
  
 接続には、オープン・カーソルが存在するステートメントが少なくとも 1 つあり、トランザクションがコミットまたはロールバックされるときに、データ・ソースはカーソルを保持します *(CompletionType*がSQL_COMMITであるかSQL_ROLLBACKであるかによって異なります)。 詳細については、 [SQLGetInfo](../../../odbc/reference/syntax/sqlgetinfo-function.md)のSQL_CURSOR_COMMIT_BEHAVIORとSQL_CURSOR_ROLLBACK_BEHAVIOR属性を参照してください。  
  
 オープン・カーソルのあるステートメントが接続に存在する場合、トランザクションがコミットまたはロールバックされたときにカーソルは保持されなかった。  
  
## <a name="sqlexecdirect-and-sqlexecute"></a>を実行します。  
  
|C0<br /><br /> 羨望なし。|C1<br /><br /> 未割り当て|C2<br /><br /> Allocated|C3<br /><br /> 必要なデータ|C4<br /><br /> 接続中|C5<br /><br /> ステートメント|C6<br /><br /> トランザクション|  
|--------------------|------------------------|----------------------|----------------------|----------------------|----------------------|------------------------|  
|(IH)|(IH)|(IH)|(IH)|(IH)|--[1] C6[2] C6[3]|--|  
  
 接続が自動コミット モードで、実行されたステートメントが*カーソル**指定*(SELECT ステートメントなど) ではありませんでした。または接続が手動コミット モードで、実行されたステートメントがトランザクションを開始しませんでした。  
  
 接続が自動コミット モードで、実行されたステートメントが*カーソル**指定*(SELECT ステートメントなど) でした。  
  
 接続が手動コミット モードで、データ ソースがトランザクションを開始した。  
  
## <a name="sqlfreehandle"></a>SQLFreeHandle  
  
|C0<br /><br /> 羨望なし。|C1<br /><br /> 未割り当て|C2<br /><br /> Allocated|C3<br /><br /> 必要なデータ|C4<br /><br /> 接続中|C5<br /><br /> ステートメント|C6<br /><br /> トランザクション|  
|--------------------|------------------------|----------------------|----------------------|----------------------|----------------------|------------------------|  
|(IH)[1]|C0|(HY010)|(HY010)|(HY010)|(HY010)|(HY010)|  
|(IH)[2]|(IH)|(C1)|(HY010)|(HY010)|(HY010)|(HY010)|  
|(IH)[3]|(IH)|(IH)|(IH)|(IH)|C4[5] --[6]|--[7] C4[5] および [8] C5[6] および [8]|  
|(IH)[4]|(IH)|(IH)|(IH)|--|--|--|  
  
 [1] この行は *、HandleType*がSQL_HANDLE_ENVされたときの遷移を示しています。  
  
 [2] この行は *、HandleType*がSQL_HANDLE_DBCされたときの遷移を示しています。  
  
 [3] この行は *、HandleType*がSQL_HANDLE_STMTされたときの遷移を示しています。  
  
 [4] この行は *、HandleType*がSQL_HANDLE_DESCされたときの遷移を示しています。  
  
 [5] 接続に割り当てられたステートメントは 1 つのみであった。  
  
 [6] 接続に複数のステートメントが割り当てられていた。  
  
 接続が手動コミットモードであった。  
  
 接続が自動コミットモードであった。  
  
## <a name="sqlfreestmt"></a>SQLFreeStmt  
  
|C0<br /><br /> 羨望なし。|C1<br /><br /> 未割り当て|C2<br /><br /> Allocated|C3<br /><br /> 必要なデータ|C4<br /><br /> 接続中|C5<br /><br /> ステートメント|C6<br /><br /> トランザクション|  
|--------------------|------------------------|----------------------|----------------------|----------------------|----------------------|------------------------|  
|(IH)[1]|(IH)|(IH)|(IH)|(IH)|--|C5[3] --[4]|  
|(IH)[2]|(IH)|(IH)|(IH)|(IH)|--|--|  
  
 [1] この行は *、Option*引数がSQL_CLOSEされた場合のトランザクションを示します。  
  
 [2] この行は *、Option*引数がSQL_UNBINDまたはSQL_RESET_PARAMSの場合にトランザクションを表示します。  
  
 接続は自動コミットモードで、この文以外の文ではカーソルが開かれなかった。  
  
 接続が手動コミット モードであったか、自動コミット モードで、カーソルが少なくとも 1 つの他のステートメントで開かれていた。  
  
## <a name="sqlgetconnectattr"></a>SQLGetConnectAttr  
  
|C0<br /><br /> 羨望なし。|C1<br /><br /> 未割り当て|C2<br /><br /> Allocated|C3<br /><br /> 必要なデータ|C4<br /><br /> 接続中|C5<br /><br /> ステートメント|C6<br /><br /> トランザクション|  
|--------------------|------------------------|----------------------|----------------------|----------------------|----------------------|------------------------|  
|Ih|Ih|--[1] 08003[2]|HY010|--|--|--|  
  
 [1]*引数が*SQL_ATTR_ACCESS_MODE、SQL_ATTR_AUTOCOMMIT、SQL_ATTR_LOGIN_TIMEOUT、SQL_ATTR_ODBC_CURSORS、SQL_ATTR_TRACE、またはSQL_ATTR_TRACEFILEであったか、接続属性に値が設定されている。  
  
 *Attribute*引数がSQL_ATTR_ACCESS_MODE、SQL_ATTR_AUTOCOMMIT、SQL_ATTR_LOGIN_TIMEOUT、SQL_ATTR_ODBC_CURSORS、SQL_ATTR_TRACE、またはSQL_ATTR_TRACEFILEで、接続属性に値が設定されていません。  
  
## <a name="sqlgetdiagfield-and-sqlgetdiagrec"></a>フィールドと SQL を取得します。  
  
|C0<br /><br /> 羨望なし。|C1<br /><br /> 未割り当て|C2<br /><br /> Allocated|C3<br /><br /> 必要なデータ|C4<br /><br /> 接続中|C5<br /><br /> ステートメント|C6<br /><br /> トランザクション|  
|--------------------|------------------------|----------------------|----------------------|----------------------|----------------------|------------------------|  
|(IH)[1]|--|--|--|--|--|--|  
|(IH)[2]|(IH)|--|--|--|--|--|  
|(IH)[3]|(IH)|(IH)|(IH)|(IH)|--|--|  
|(IH)[4]|(IH)|(IH)|(IH)|--|--|--|  
  
 [1] この行は *、HandleType*がSQL_HANDLE_ENVされたときの遷移を示しています。  
  
 [2] この行は *、HandleType*がSQL_HANDLE_DBCされたときの遷移を示しています。  
  
 [3] この行は *、HandleType*がSQL_HANDLE_STMTされたときの遷移を示しています。  
  
 [4] この行は *、HandleType*がSQL_HANDLE_DESCされたときの遷移を示しています。  
  
## <a name="sqlgetenvattr"></a>アズ・ビジトル  
  
|C0<br /><br /> 羨望なし。|C1<br /><br /> 未割り当て|C2<br /><br /> Allocated|C3<br /><br /> 必要なデータ|C4<br /><br /> 接続中|C5<br /><br /> ステートメント|C6<br /><br /> トランザクション|  
|--------------------|------------------------|----------------------|----------------------|----------------------|----------------------|------------------------|  
|Ih|--|--|--|--|--|--|  
  
## <a name="sqlgetfunctions"></a>SQLGetFunctions  
  
|C0<br /><br /> 羨望なし。|C1<br /><br /> 未割り当て|C2<br /><br /> Allocated|C3<br /><br /> 必要なデータ|C4<br /><br /> 接続中|C5<br /><br /> ステートメント|C6<br /><br /> トランザクション|  
|--------------------|------------------------|----------------------|----------------------|----------------------|----------------------|------------------------|  
|Ih|Ih|HY010|HY010|--|--|--|  
  
## <a name="sqlgetinfo"></a>SQLGetInfo  
  
|C0<br /><br /> 羨望なし。|C1<br /><br /> 未割り当て|C2<br /><br /> Allocated|C3<br /><br /> 必要なデータ|C4<br /><br /> 接続中|C5<br /><br /> ステートメント|C6<br /><br /> トランザクション|  
|--------------------|------------------------|----------------------|----------------------|----------------------|----------------------|------------------------|  
|Ih|Ih|--[1] 08003[2]|08003|--|--|--|  
  
 [1]*インフォタイプ*引数がSQL_ODBC_VER。  
  
 [2]*インフォタイプ*引数がSQL_ODBC_VERされませんでした。  
  
## <a name="sqlmoreresults"></a>SQLMoreResults  
  
|C0<br /><br /> 羨望なし。|C1<br /><br /> 未割り当て|C2<br /><br /> Allocated|C3<br /><br /> 必要なデータ|C4<br /><br /> 接続中|C5<br /><br /> ステートメント|C6<br /><br /> トランザクション|  
|--------------------|------------------------|----------------------|----------------------|----------------------|----------------------|------------------------|  
|(IH)|(IH)|(IH)|(IH)|(IH)|--[1] C6[2]|--[3] C5[1]|  
  
 接続が自動コミット・モードで **、SQLMoreResults**の呼び出しでカーソル指定の結果セットの処理が初期化されていません。  
  
 接続が自動コミット・モードで **、SQLMoreResults**の呼び出しによってカーソル指定の結果セットの処理が初期化されました。  
  
 接続が手動コミットモードであった。  
  
## <a name="sqlnativesql"></a>SQLNativeSql  
  
|C0<br /><br /> 羨望なし。|C1<br /><br /> 未割り当て|C2<br /><br /> Allocated|C3<br /><br /> 必要なデータ|C4<br /><br /> 接続中|C5<br /><br /> ステートメント|C6<br /><br /> トランザクション|  
|--------------------|------------------------|----------------------|----------------------|----------------------|----------------------|------------------------|  
|(IH)|(IH)|(08003)|(08003)|--|--|--|  
  
## <a name="sqlprepare"></a>SQLPrepare  
  
|C0<br /><br /> 羨望なし。|C1<br /><br /> 未割り当て|C2<br /><br /> Allocated|C3<br /><br /> 必要なデータ|C4<br /><br /> 接続中|C5<br /><br /> ステートメント|C6<br /><br /> トランザクション|  
|--------------------|------------------------|----------------------|----------------------|----------------------|----------------------|------------------------|  
|(IH)|(IH)|(IH)|(IH)|(IH)|--[1] C6[2]|--|  
  
 接続が自動コミット モードであるか、データ ソースがトランザクションを開始しませんでした。  
  
 接続が手動コミット モードで、データ ソースがトランザクションを開始しました。  
  
## <a name="sqlsetconnectattr"></a>SQLSetConnectAttr  
  
|C0<br /><br /> 羨望なし。|C1<br /><br /> 未割り当て|C2<br /><br /> Allocated|C3<br /><br /> 必要なデータ|C4<br /><br /> 接続中|C5<br /><br /> ステートメント|C6<br /><br /> トランザクション|  
|--------------------|------------------------|----------------------|----------------------|----------------------|----------------------|------------------------|  
|Ih|Ih|--[1] 08003[2]|HY010|--[3] 08002[4] HY011[5]|--[3] 08002[4] HY011[5]|--[3] および [6] C5[8] 08002[4] HY011[5] または [7]|  
  
 Attribute*引数が*SQL_ATTR_TRANSLATE_LIBまたはSQL_ATTR_TRANSLATE_OPTIONされていません。  
  
 Attribute*引数が*SQL_ATTR_TRANSLATE_LIBまたはSQL_ATTR_TRANSLATE_OPTION。  
  
 Attribute*引数が*SQL_ATTR_ODBC_CURSORSまたはSQL_ATTR_PACKET_SIZEされなかった。  
  
 Attribute*引数が*SQL_ATTR_ODBC_CURSORS。  
  
 Attribute*引数が*SQL_ATTR_PACKET_SIZE。  
  
 Attribute*引数が*SQL_ATTR_AUTOCOMMITされていないか *、Attribute*引数がSQL_ATTR_AUTOCOMMITされ、この属性を設定してもトランザクションがコミットされなかった。  
  
 [7]*属性*引数がSQL_ATTR_TXN_ISOLATION。  
  
 Attribute*引数が*SQL_ATTR_AUTOCOMMITされ、この属性を設定するとトランザクションがコミットされました。  
  
## <a name="sqlsetenvattr"></a>SQLSetEnvAttr  
  
|C0<br /><br /> 羨望なし。|C1<br /><br /> 未割り当て|C2<br /><br /> Allocated|C3<br /><br /> 必要なデータ|C4<br /><br /> 接続中|C5<br /><br /> ステートメント|C6<br /><br /> トランザクション|  
|--------------------|------------------------|----------------------|----------------------|----------------------|----------------------|------------------------|  
|(IH)|--|--|(HY010)|--|--|--|  
  
## <a name="all-other-odbc-functions"></a>その他すべての ODBC 関数  
  
|C0<br /><br /> 羨望なし。|C1<br /><br /> 未割り当て|C2<br /><br /> Allocated|C3<br /><br /> 必要なデータ|C4<br /><br /> 接続中|C5<br /><br /> ステートメント|C6<br /><br /> トランザクション|  
|--------------------|------------------------|----------------------|----------------------|----------------------|----------------------|------------------------|  
|(IH)|(IH)|(IH)|(IH)|(IH)|--|--|
