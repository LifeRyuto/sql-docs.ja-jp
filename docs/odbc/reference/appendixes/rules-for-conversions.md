---
title: 変換のルール |マイクロソフトドキュメント
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- numeric data type [ODBC], literals
- conversions with numeric literals [ODBC]
- numeric literals [ODBC]
- literals [ODBC], numeric
ms.assetid: 89f846a3-001d-496a-9843-ac9c38dc1762
author: David-Engel
ms.author: v-daenge
ms.openlocfilehash: c49177d62fffc3b3b5c47a25bf3fb421d7564245
ms.sourcegitcommit: ce94c2ad7a50945481172782c270b5b0206e61de
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/14/2020
ms.locfileid: "81305088"
---
# <a name="rules-for-conversions"></a>変換規則
このセクションの規則は、数値リテラルに関係する変換に適用されます。 これらのルールの目的のために、次の用語が定義されています。  
  
-   *ストアの割り当て:* データベースのテーブル列にデータを送信する場合。 これは **、SQL 実行****、SQLExecDirect、** および**SQLSetPos**の呼び出し中に発生します。 ストアの割り当て中に"ターゲット" はデータベース列を指し、"ソース" はアプリケーション バッファ内のデータを参照します。  
  
-   *取得の割り当て:* データベースからアプリケーション バッファにデータを取得する場合。 これは **、SQL フェッチ****、SQLGet データ****、SQL フェッチスクロール**、および**SQL セットポス**の呼び出し中に発生します。 取得割り当て時に、「ターゲット」はアプリケーションバッファを指し、「ソース」はデータベース列を指します。  
  
-   *CS:* 文字ソースの値。  
  
-   *NT:* 数値ターゲットの値。  
  
-   *NS:* 数値ソースの値。  
  
-   *CT:* 文字ターゲットの値。  
  
-   正確な数値リテラルの精度: 含まれる桁数。  
  
-   正確な数値リテラルの位取り: 明示的または暗黙的なピリオドの右側の桁数。  
  
-   概数値リテラルの精度: そのカマシの精度。  
  
## <a name="character-source-to-numeric-target"></a>文字ソースから数値ターゲット  
 文字ソース (CS) から数値ターゲット (NT) への変換の規則は次のとおりです。  
  
1.  CS の先頭または末尾のスペースを削除して得られる値に置き換えます。 CS が有効な*数値リテラル*でない場合は、SQLSTATE 22018 (キャスト指定に無効な文字値) が戻されます。  
  
2.  CS を、小数点より前の先行ゼロ、小数点の後の後続ゼロ、またはその両方を除去することによって得られる値に置き換えます。  
  
3.  CS を NT に変換します。 変換によって有効桁が失われた場合は、SQLSTATE 22003 (数値が範囲外) として返されます。 変換によって非有効桁数が失われた場合は、SQLSTATE 01S07 (分数切り捨て) が返されます。  
  
## <a name="numeric-source-to-character-target"></a>数値ソースから文字ターゲット  
 数値ソース (NS) から文字ターゲット (CT) への変換の規則は次のとおりです。  
  
1.  LT を CT の文字で長くします。 取得割り当ての場合、LT は、この文字セットの NULL 終了文字のバイト数を引いた文字数のバッファーの長さに等しくなります。  
  
2.  場合：  
  
    -   NS が正確な数値型の場合は、YP のスケールが NS のスケールと同じになるように *、正確な数値リテラル*の定義に準拠する最短の文字列に YP を等しくし、YP の解釈値が NS の絶対値になるようにします。  
  
    -   NS が近似数値タイプの場合は、YP を次のように文字列にします。  
  
         大文字と小文字の区別:  
  
         NS が 0 の場合、YP は 0 になります。  
  
         YSN を、正確な*数値リテラル*の定義に準拠し、解釈値が NS の絶対値である最短の文字列にします。 YSN の長さが NS のデータ・タイプの (*精度*+ 1) より小さい場合は、YP が YSN と等しくなる。  
  
         それ以外の場合、YP は、解釈値が NS の絶対値であり、*そのマンティッサ*が '0' 以外の 1*桁の後*に*ピリオド*と*符号なし整数*で構成される *、概数リテラル*の定義に準拠する最短の文字列です。  
  
3.  大文字と小文字の区別:  
  
    -   NS が 0 未満の場合は、Y を次の結果にします。  
  
         '-' &#124;&#124; YP  
  
         ここで '&#124;&#124;' は文字列連結演算子です。  
  
         それ以外の場合は、Y を YP に等しくします。  
  
4.  LY を Y の文字で長くします。  
  
5.  大文字と小文字の区別:  
  
    -   LY が LT と等しい場合、CT は Y に設定されます。  
  
    -   LY が LT より小さい場合、CT は適切な数のスペースで右に拡張される Y に設定されます。  
  
         それ以外の場合 (LY > LT)、Y の最初の LT 文字を CT にコピーします。  
  
         大文字と小文字の区別:  
  
         これがストア割り当てである場合は、エラー SQLSTATE 22001 (文字列データ、右切り捨て) を返します。  
  
         これが検索割り当てである場合は、警告 SQLSTATE 01004 (ストリング・データ、右切り捨て) を戻します。 コピーの結果、小数部の数字 (末尾のゼロ以外) が失われる場合、次のいずれかが発生するかどうかは、ドライバーが定義されます。  
  
         (1) ドライバーは Y の文字列を適切なスケール (0 も可能) に切り捨て、結果を CT に書き込みます。  
  
         (2) ドライバーは Y で文字列を適切なスケール (0 も可能) に丸め、結果を CT に書き込みます。  
  
         (3) ドライバは切り捨ても丸めもせず、Y の最初の LT 文字を CT にコピーするだけです。
