---
title: ODBC ソリューション |マイクロソフトドキュメント
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- ODBC [ODBC], database access
- SQL [ODBC], database access
- database access [ODBC]
- standardizing database access [ODBC], using ODBC
ms.assetid: 34b80790-e010-4b90-8eaa-03189f5d8986
author: David-Engel
ms.author: v-daenge
ms.openlocfilehash: 2b35883ff4d621f0ecc092020ad744455281dd63
ms.sourcegitcommit: ce94c2ad7a50945481172782c270b5b0206e61de
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/14/2020
ms.locfileid: "81286755"
---
# <a name="the-odbc-solution"></a>ODBC ソリューション
問題は、ODBC がデータベース アクセスをどのように標準化するかということです。 次の 2 つのアーキテクチャ要件があります。  
  
-   アプリケーションは、再コンパイルや再リンクを行わずに、同じソースコードを使用して複数の DBMS にアクセスできる必要があります。  
  
-   アプリケーションは、複数の DBMS に同時にアクセスできる必要があります。  
  
 そして、市場の現実のために、もう一つの質問があります:  
  
-   ODBC が公開する必要がある DBMS 機能はどれですか。 すべての DBMS に共通する機能、または DBMS で使用できる機能のみ。  
  
 ODBC では、次のようにこれらの問題を解決します。  
  
-   **ODBC は、呼び出しレベルのインターフェイスです。** 同じソース コードを使用してアプリケーションが複数の Dbms にアクセスする方法の問題を解決するために、ODBC は標準 CLI を定義します。 この機能には、オープングループおよび ISO/IEC の CLI 仕様のすべての機能が含まれ、アプリケーションで一般的に必要となる追加機能が提供されます。  
  
     ODBC をサポートする DBMS ごとに、異なるライブラリまたはドライバが必要です。 ドライバーは、ODBC API の関数を実装します。 別のドライバを使用するには、アプリケーションを再コンパイルまたは再リンクする必要はありません。 代わりに、アプリケーションは単に新しいドライバーを読み込み、その中の関数を呼び出します。 複数の DBMS に同時にアクセスするには、アプリケーションは複数のドライバーを読み込みます。 ドライバのサポート方法は、オペレーティング システムに固有です。 たとえば、Microsoft® Windows® オペレーティング システムでは、ドライバーはダイナミック リンク ライブラリ (DLL) です。  
  
-   **ODBC は、標準の SQL 文法を定義します。** ODBC では、標準の呼び出しレベル のインターフェイスに加えて、標準の SQL 文法を定義します。 この文法は、オープン グループ SQL CAE 仕様に基づいています。 2 つの文法の違いは小さいものであり、主に組み込み SQL (グループを開く) と CLI (ODBC) で必要な SQL 文法の違いが原因です。 また、Open Group 文法でカバーされない一般的に利用可能な言語機能を公開するための、文法の拡張機能もいくつか用意されています。  
  
     アプリケーションは、ODBC または DBMS 固有の文法を使用してステートメントを送信できます。 ステートメントが DBMS 固有の文法とは異なる ODBC 文法を使用している場合、ドライバーはデータ ソースに送信する前に変換します。 ただし、ほとんどの DBMS では標準の SQL 文法が既に使用されているため、このような変換はまれです。  
  
-   **ODBC は、複数の Dbms への同時アクセスを管理するドライバー マネージャーを提供します。** ドライバーを使用すると、複数の DBMS に同時にアクセスする問題は解決しますが、これを行うコードは複雑になる可能性があります。 すべてのドライバーで動作するように設計されたアプリケーションは、どのドライバーにも静的にリンクすることはできません。 代わりに、実行時にドライバーをロードし、関数ポインターのテーブルを通じて、その中の関数を呼び出す必要があります。 アプリケーションが複数のドライバーを同時に使用する場合、状況はより複雑になります。  
  
     ODBC では、各アプリケーションに強制的にこの操作を行うのではなく、ドライバー マネージャーを提供します。 ドライバー マネージャーは、すべての ODBC 関数を実装します - 主にドライバーで ODBC 関数へのパススルー呼び出しとして - 静的にアプリケーションにリンクまたは実行時にアプリケーションによって読み込まれます。 したがって、アプリケーションは、各ドライバーのポインターではなく、ドライバー マネージャーで名前で ODBC 関数を呼び出します。  
  
     アプリケーションは、特定のドライバーを必要とする場合は、最初にドライバーを識別する接続ハンドルを要求し、ドライバー マネージャードライバーを読み込む要求します。 ドライバー マネージャーは、ドライバーを読み込み、ドライバーの各関数のアドレスを格納します。 ドライバーで ODBC 関数を呼び出すために、アプリケーションは、ドライバー マネージャーでその関数を呼び出し、ドライバーの接続ハンドルを渡します。 ドライバー マネージャーは、以前に格納されているアドレスを使用して関数を呼び出します。  
  
-   **ODBC は、多くの DBMS 機能を公開しますが、ドライバがすべての機能をサポートする必要はありません。** ODBC がすべての Dbms に共通の機能のみを公開した場合、ほとんど使用できません。結局のところ、今日、非常に多くの異なるDBMSが存在する理由は、それらが異なる機能を持っているからである。 ODBC が DBMS で使用できるすべての機能を公開した場合、ドライバーを実装することは不可能です。  
  
     代わりに、ODBC は多くの機能 (ほとんどの Dbms でサポートされている機能) を公開しますが、ドライバーは、これらの機能のサブセットのみを実装する必要があります。 ドライバーは、基になる DBMS でサポートされている場合、またはそれらをエミュレートする場合にのみ、残りの機能を実装します。 したがって、アプリケーションは、その DBMS 用のドライバーによって公開される単一の DBMS の機能を利用したり、すべての DBMS で使用される機能のみを使用したり、特定の機能のサポートをチェックしてそれに応じて対応したりするために作成できます。  
  
     アプリケーションがドライバーと DBMS サポートの機能を決定できるように、ODBC には、ドライバーと DBMS の機能に関する一般的な情報とドライバーがサポートする関数の一覧を返す 2 つの関数 (**SQLGetInfo**と**SQLGetFunctions**) が用意されています。 ODBC では、API および SQL の文法準拠レベルも定義され、ドライバでサポートされる幅広い機能を指定します。 詳細については、「[準拠レベル](../../odbc/reference/develop-app/conformance-levels.md)」を参照してください。  
  
     ODBC が公開するすべての機能に共通のインターフェイスを定義することに注意してください。 このため、アプリケーションには DBMS 固有のコードではなく機能固有のコードが含まれ、これらの機能を公開する任意のドライバーを使用できます。 この利点の 1 つは、DBMS でサポートされている機能が拡張されたときにアプリケーションを更新する必要がなされないことです。代わりに、更新されたドライバがインストールされると、アプリケーションは機能を自動的に使用します。
