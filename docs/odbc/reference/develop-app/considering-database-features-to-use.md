---
title: データベース機能の使用を検討する |マイクロソフトドキュメント
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- interoperability [ODBC], database features
ms.assetid: 59760114-508e-46c5-81d2-8f2498c0d778
author: David-Engel
ms.author: v-daenge
ms.openlocfilehash: a9d966781def1c3eab6a9568eab07ab591326171
ms.sourcegitcommit: ce94c2ad7a50945481172782c270b5b0206e61de
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/14/2020
ms.locfileid: "81299012"
---
# <a name="considering-database-features-to-use"></a>使用するデータベース機能の検討
基本的な相互運用性が判明したら、アプリケーションで使用されるデータベース機能を考慮する必要があります。 たとえば、アプリケーションで実行される SQL ステートメントは何か。 アプリケーションはスクロール可能なカーソルを使用しますか? トランザクション。 手順。 長いデータ? すべての Dbms でサポートされない機能についてのアイデアについては、 [SQLGetInfo](../../../odbc/reference/syntax/sqlgetinfo-function.md)、 [SQLSetConnectAttr](../../../odbc/reference/syntax/sqlsetconnectattr-function.md)、および[SQLSetStmtAttr](../../../odbc/reference/syntax/sqlsetstmtattr-function.md)関数の説明、および[付録 C: SQL 文法](../../../odbc/reference/appendixes/appendix-c-sql-grammar.md)を参照してください。 アプリケーションに必要な機能により、ターゲット DBMS のリストから一部の DBMS が削除される場合があります。 また、アプリケーションが多くの DBMS を容易にターゲットにできることも示している場合があります。  
  
 たとえば、必要な機能が単純な場合、通常は高度な相互運用性を持って実装できます。 単純な**SELECT**ステートメントを実行し、前方のみのカーソルで結果を取得するアプリケーションは、その単純性により、相互運用性が高くなる可能性があります。  
  
 ただし、必要な機能 (スクロール可能なカーソル、位置指定更新および削除ステートメント、プロシージャなど) がより複雑な場合は、多くの場合、トレードオフを行う必要があります。 いくつかの可能性があります。  
  
-   **相互運用性の低下、機能の向上。** アプリケーションには機能が含まれていますが、それらをサポートする Dbms でのみ動作します。  
  
-   **相互運用性が高く、機能が少なくなります。** アプリケーションは機能を削除しますが、より多くの DBMS で動作します。  
  
-   **相互運用性の向上、オプション機能。** アプリケーションには機能が含まれていますが、それらをサポートする Dbms でのみ使用できます。  
  
-   **相互運用性が高く、機能が増えます。** アプリケーションは、それらをサポートする Dbms を備えた機能を使用し、サポートしていない DBMS の場合はエミュレートします。  
  
 最初の 2 つのケースは、サポートされているすべての Dbms で使用されるか、または何も使用しないため、実装が比較的簡単です。 一方、後者の2つのケースはより複雑です。 どちらの場合も、DBMS が機能をサポートしているかどうかを確認し、最後のケースではこれらの機能をエミュレートするために大量のコードを記述する必要があります。 したがって、これらのスキームは、より多くの開発時間を必要とし、実行時に遅くなる可能性があります。  
  
 単一のデータ ソースに接続できる汎用クエリ アプリケーションを考えてみます。 アプリケーションはユーザーからのクエリを受け取り、結果をウィンドウに表示します。 このアプリケーションには、複数のクエリの結果を同時に表示できる機能が 1 つあるとします。 つまり、クエリを実行して結果の一部を確認し、別のクエリを実行して結果の一部を確認し、最初のクエリに戻ることができます。 一部のドライバーは、1 つのアクティブ ステートメントのみをサポートするため、相互運用性の問題が発生します。  
  
 アプリケーションには **、SQLGetInfo**のSQL_MAX_CONCURRENT_ACTIVITIES オプションのドライバーが返す内容に基づいて、さまざまな選択肢があります。  
  
-   **常に複数のクエリをサポートします。** ドライバーに接続した後、アプリケーションはアクティブなステートメントの数を確認します。 ドライバーは、1 つのアクティブなステートメントをサポートしている場合、アプリケーションは接続を閉じ、ドライバーが必要な機能をサポートしていないことをユーザーに通知します。 アプリケーションは簡単に実装でき、機能は完全ですが、相互運用性は低くなります。  
  
-   **複数のクエリをサポートしないでください。** アプリケーションは、機能を完全に削除します。 実装が容易で、相互運用性は高いが、機能が少ない。  
  
-   **ドライバーがサポートしている場合にのみ、複数のクエリをサポートします。** ドライバーに接続した後、アプリケーションはアクティブなステートメントの数を確認します。 アプリケーションでは、ドライバーが複数のアクティブなステートメントをサポートしている場合にのみ、新しいステートメントを開始するユーザーを許可します。 アプリケーションの機能と相互運用性は高くなりますが、実装は困難です。  
  
-   **常に複数のクエリをサポートし、必要に応じてエミュレートします。** ドライバーに接続した後、アプリケーションはアクティブなステートメントの数を確認します。 アプリケーションでは、ユーザーが既にアクティブな場合に、常に新しいステートメントを開始できます。 ドライバーが 1 つのアクティブなステートメントをサポートしている場合、アプリケーションはそのドライバーへの追加の接続を開き、その接続で新しいステートメントを実行します。 アプリケーションは、完全な機能と高い相互運用性を持っていますが、実装するのは難しいです。
