---
title: スクロール可能なカーソル |マイクロソフトドキュメント
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- scrollable cursors [ODBC]
- cursors [ODBC], scrollable
ms.assetid: 2c8a5f50-9b37-452f-8160-05f42bc4d97e
author: David-Engel
ms.author: v-daenge
ms.openlocfilehash: 2762ffc7fa179fc6a68f92c23f92ca12803f5ab7
ms.sourcegitcommit: ce94c2ad7a50945481172782c270b5b0206e61de
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/14/2020
ms.locfileid: "81304213"
---
# <a name="scrollable-cursors"></a>スクロール可能なカーソル
最近の画面ベースのアプリケーションでは、ユーザーはデータを前後にスクロールします。 このようなアプリケーションでは、以前にフェッチした行に戻す方法が問題になります。 1 つの方法として、カーソルを閉じて再度開き、カーソルが必要な行に到達するまで行をフェッチする方法があります。 もう 1 つの方法として、結果セットを読み取り、ローカルにキャッシュし、アプリケーションでスクロールを実装する方法があります。 どちらの可能性も小さな結果セットでのみうまく機能し、後者の可能性を実装することは困難です。 より良い解決策は、結果セット内で前後に移動できる*スクロール可能なカーソル*を使用することです。  
  
 *スクロール可能なカーソル*は、一般的に、ユーザーがデータを前後にスクロールする最新の画面ベースのアプリケーションで使用されます。 ただし、アプリケーションは、順方向のカーソルがジョブを実行しない場合にのみ、スクロール可能カーソルを使用する必要があります。  
  
 後方に移動する機能は、前方スクロールカーソルには適用されない問題を提起する: スクロール可能なカーソルは、以前にフェッチされた行に加えられた変更を検出する必要がありますか? つまり、更新、削除、および新しく挿入された行を検出する必要がありますか?  
  
 この問題は、結果セットの定義 (特定の条件に一致する行のセット) が、その条件に一致するかどうかを確認する行をチェックする際に、また、行がフェッチされるたびに同じデータを含める必要があるかどうかを示さないために発生します。 前者の省略により、スクロール可能なカーソルが行が挿入または削除されたかどうかを検出することができ、後者は更新されたデータを検出することができます。  
  
 変更を検出する機能は、時には有用であり、時には有用ではありません。 たとえば、アカウンティング アプリケーションには、すべての変更を無視するカーソルが必要です。カーソルに最新の変更が表示されている場合、ブックのバランスはできません。 一方、航空会社の予約システムには、データに対する最新の変更を示すカーソルが必要です。このようなカーソルを使用しない場合は、データベースを継続的に再クエリして、最新のフライトの可用性を示す必要があります。  
  
 さまざまなアプリケーションのニーズを満たすには、ODBC は 4 種類のスクロール可能なカーソルを定義します。 これらのカーソルは、コストと結果セットへの変更を検出する機能の両方で変化します。 スクロール可能なカーソルが行の変更を検出できる場合、それらの行を再フェッチしようとしたときにのみ検出できることに注意してください。データ ソースが現在フェッチされている行に対する変更をカーソルに通知する方法はありません。 なお、変更の可視性は、トランザクション分離レベルによっても制御されます。詳細については、「[トランザクションの分離](../../../odbc/reference/develop-app/transaction-isolation.md)」を参照してください。  
  
 このセクションでは、次のトピックを扱います。  
  
-   [スクロール可能なカーソルの種類](../../../odbc/reference/develop-app/scrollable-cursor-types.md)  
  
-   [スクロール可能なカーソルの使用](../../../odbc/reference/develop-app/using-scrollable-cursors.md)  
  
-   [相対と絶対のスクロール](../../../odbc/reference/develop-app/relative-and-absolute-scrolling.md)  
  
-   [ブックマーク](../../../odbc/reference/develop-app/bookmarks-odbc.md)
