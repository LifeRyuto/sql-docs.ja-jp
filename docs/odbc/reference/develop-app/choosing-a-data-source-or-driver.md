---
title: データ ソースまたはドライバの選択 |マイクロソフトドキュメント
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- connecting to driver [ODBC], selecting driver
- connecting to data source [ODBC], selecting data source
- data sources [ODBC], selecting
- ODBC drivers [ODBC], selecting
ms.assetid: 10aaf570-01ab-4478-8339-bdde2a5e3dd1
author: David-Engel
ms.author: v-daenge
ms.openlocfilehash: b10aafad95463f56ec0f5a029eac59a02cff003b
ms.sourcegitcommit: ce94c2ad7a50945481172782c270b5b0206e61de
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/14/2020
ms.locfileid: "81303373"
---
# <a name="choosing-a-data-source-or-driver"></a>データ ソースまたはドライバーの選択
アプリケーションで使用されるデータ ソースまたはドライバは、アプリケーション内でハードコーディングされる場合があります。 たとえば、MIS 部門がデータ ソース間でデータを転送するために作成したカスタム アプリケーションには、それらのデータ ソースの名前が含まれます。 もう 1 つの例は、注文入力に使用されるような垂直アプリケーションです。 このようなアプリケーションは常に同じデータ ソースを使用します。  
  
 他のアプリケーションでは、実行時にデータ ソースまたはドライバを選択します。 通常、ODBC を使用してデータをインポートするスプレッドシートなど、アドホック クエリを実行する汎用アプリケーションです。 このようなアプリケーションは、通常、利用可能なデータ ソースまたはドライバーを一覧表示し、ユーザーが作業するドライバーを選択できるようにします。 汎用アプリケーションがデータ ソース、ドライバ、またはその両方を頻繁にリストするかどうかは、アプリケーションが DBMS ベースのドライバとファイル ベース ドライバのどちらを使用するかによって異なります。  
  
 DBMS ベースのドライバには、通常、ネットワーク アドレス、ネットワーク プロトコル、データベース名などの複雑な接続情報のセットが必要です。 データ ソースの目的は、この情報をすべて非表示にすることです。 したがって、データ ソースパラダイムは DBMS ベースのドライバで使用できます。 アプリケーションは、2 つの方法のいずれかで、ユーザーにデータ ソースの一覧を表示できます。 **DSN** (データ ソース名) キーワードを使用して**SQLDriverConnect**を呼び出し、関連付けられた値を指定することはできません。ドライバー マネージャーは、データ ソース名の一覧を表示します。 アプリケーションがリストの外観を制御する場合は **、SQLDataSources**を呼び出して使用可能なデータ ソースの一覧を取得し、独自のダイアログ ボックスを作成します。 この関数は、ドライバー マネージャーによって実装され、ドライバーが読み込まれる前に呼び出すことができます。 アプリケーションは接続関数を呼び出し、選択したデータ ソースの名前を渡します。  
  
 データ ソースが指定されていない場合は、システム情報によって示される既定のデータ ソースが使用されます。 (詳細については、「[既定のサブキー](../../../odbc/reference/install/default-subkey.md)」を参照してください)。**SQLConnect**が、見つからない、null ポインター、または "DEFAULT" である*サーバー名*引数を使用して呼び出された場合、ドライバー マネージャーは既定のデータ ソースに接続します。 **SQLDriverConnect**または**SQLBrowseConnect**の呼び出しで使用される接続文字列に DSN**キーワードが**"DEFAULT" に設定されている場合、または指定されたデータ ソースが見つからない場合にも、既定のデータ ソースが使用されます。 さらに、既定のデータ ソースは **、SQLDriverConnect**の呼び出しで使用される接続文字列に**DSN**キーワードが含まれていない場合に使用されます。  
  
 ファイルベースのドライバでは、ファイルパラダイムを使用できます。 ローカル コンピューターに格納されているデータの場合、ユーザーは、自分のデータが Employee.dbf などの特定のファイルに含まれていることがわかります。 不明なデータ ソースを選択する代わりに、ユーザーが知っているファイルを選択する方が簡単です。 これを実装するために、アプリケーションは最初に**SQLDrivers**を呼び出します。 この関数は、ドライバー マネージャーによって実装され、ドライバーが読み込まれる前に呼び出すことができます。 **SQLDrivers は、** 使用可能なドライバーの一覧を返します。また **、FileUsage**キーワードと**FileExtns**キーワードの値も返します。 **FileUsage**キーワードは、ファイル ベースのドライバーがファイルをテーブルとして扱うか、Xbase と同じように扱うか、データベースとして扱うか®を説明します。 **FileExtns**キーワードは、Xbase ドライバーの .dbf など、ドライバーが認識するファイル名拡張子を一覧表示します。 この情報を使用して、アプリケーションはユーザーがファイルを選択するためのダイアログ ボックスを作成します。 選択したファイルの拡張子に基づいて、アプリケーションは **、ドライバー**キーワードを使用して**SQLDriverConnect**を呼び出すことによってドライバーに接続します。  
  
 アプリケーションがファイル ベースのドライバーを使用してデータ ソースを使用したり **、SQLDriverConnect**を呼び出す**ドライバーを使用して、DBMS**ベースのドライバーに接続するドライバーのキーワードを停止する必要はありません。 DBMS ベースのドライバに対する**DRIVER**キーワードの一般的な使用方法を次に示します。  
  
-   **データ ソースを作成しません。** たとえば、カスタム アプリケーションでは、特定のドライバーとデータベースを使用する場合があります。 ドライバ名とデータベースへの接続に必要なすべての情報がアプリケーションでハードコーディングされている場合、ユーザーはアプリケーションを実行するためにコンピュータ上にデータ ソースを作成する必要はありません。 彼らがしなければならないのは、アプリケーションとドライバをインストールすることだけです。  
  
     この方法の欠点は、接続情報が変更された場合にアプリケーションを再コンパイルし、再配布する必要がある点です。 データ ソース名が完全な接続情報ではなく、アプリケーションでハードコーディングされている場合、各ユーザーはデータ ソースの情報のみを変更する必要があります。  
  
-   **特定の DBMS に 1 回アクセスする。** たとえば、ODBC 関数を呼び出してデータを取得するスプレッドシートには、特定のドライバーを識別する**DRIVER**キーワードが含まれている場合があります。 ドライバー名は、そのドライバーを持つすべてのユーザーに意味があるので、スプレッドシートはそれらのユーザーの間で渡すことができます。 スプレッドシートにデータ ソース名が含まれている場合、各ユーザーはスプレッドシートを使用するために同じデータ ソースを作成する必要があります。  
  
-   **特定のドライバからアクセス可能なすべてのデータベースのシステムを参照する。** 詳細については、このセクション[の後半の「SQLBrowseConnect を使用した接続](../../../odbc/reference/develop-app/connecting-with-sqlbrowseconnect.md)」を参照してください。
