---
title: DLL のトレース |マイクロソフトドキュメント
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- trace DLLs [ODBC]
- tracing options [ODBC], trace DLLs
ms.assetid: 5ab99bd3-cdc3-4e2c-8827-932d1fcb6e00
author: David-Engel
ms.author: v-daenge
ms.openlocfilehash: 8e1f9dc57415ad9865ca1b2ad02487b62a93f18f
ms.sourcegitcommit: ce94c2ad7a50945481172782c270b5b0206e61de
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/14/2020
ms.locfileid: "81298072"
---
# <a name="trace-dll"></a>トレース DLL
トレースを実行する DLL は、ODBC コア コンポーネントの 1 つです。 トレース DLL は、現在 Windows SDK の ODBC コンポーネントでサンプル DLL として提供されており、以前は Microsoft データ アクセス コンポーネント (MDAC) SDK が含まれていました。 そのため、トレース DLL のレジストリ エントリ、インターフェイス、およびサンプル コードを使用できます。 この DLL は、ODBC ユーザーまたはサード パーティ ベンダによって生成されたトレース DLL に置き換えることができます。 カスタム トレース DLL には、元のサンプル トレース DLL とは異なる名前を付ける必要があります。 トレース DLL は、システム ディレクトリにインストールする必要があります。 接続文字列は、ドライバー マネージャーによってトレース DLL に渡されません。  
  
 トレース DLL は、入力引数、出力引数、遅延引数、戻りコード、および SQLSTATE をトレースします。 トレースが有効になっている場合、ドライバー マネージャーは、2 つのポイントでトレース DLL を呼び出します: 関数のエントリ時 (引数の検証前) と関数が戻る直前にもう一度。  
  
 アプリケーションが関数を呼び出すと、ドライバー マネージャーは、ドライバーで関数を呼び出すか、呼び出し自体を処理する前に、トレース DLL のトレース関数を呼び出します。 各 ODBC 関数には、名前を除いて ODBC 関数と同じ 、対応するトレース関数 (*トレース*が付いた ) があります。 トレース関数が呼び出されると、トレース DLL は入力引数をキャプチャし、戻りコードを返します。 ドライバー マネージャーが引数を検証する前にトレース DLL が呼び出されるため、無効な関数呼び出しがトレースされるため、状態遷移エラーと無効な引数がログに記録されます。  
  
 トレース DLL でトレース関数を呼び出した後、ドライバー マネージャーは、ドライバーで ODBC 関数を呼び出します。 次に、トレース DLL で**TraceReturn**を呼び出します。 この関数は、トレース関数のトレース DLL によって返される値と、ODBC 関数のドライバー マネージャーにドライバーから返されるリターン コード (またはドライバー マネージャーが関数を処理した場合はドライバー マネージャーが返す値) の 2 つの引数を受け取ります。 この関数は、トレース関数に返された値を使用して、キャプチャされた入力引数値を操作します。 ODBC 関数に返されたコードをログ ファイルに書き込みます (有効になっている場合は動的に表示されます)。 出力引数ポインターを逆参照し、出力引数の値をログに記録します。
