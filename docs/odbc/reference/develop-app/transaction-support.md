---
title: トランザクションサポート |マイクロソフトドキュメント
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- transactions [ODBC], degree of support
ms.assetid: d56e1458-8da2-4d73-a777-09e045c30a33
author: David-Engel
ms.author: v-daenge
ms.openlocfilehash: a5b9d731d12329a4ef663b1ea66cdc59a0b153fa
ms.sourcegitcommit: ce94c2ad7a50945481172782c270b5b0206e61de
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/14/2020
ms.locfileid: "81297980"
---
# <a name="transaction-support"></a>トランザクションのサポート
トランザクションのサポートの度合いは、ドライバーで定義されます。 ODBC は、データに対する複数の更新を管理する必要のない単一ユーザーまたはデスクトップ データベースに実装されるように設計されています。 さらに、トランザクションをサポートするデータベースの中には、SQL のデータ操作言語 (DML) ステートメントに対してのみサポートされるデータベースもあります。トランザクションがアクティブな場合、データ定義言語 (DDL) の使用に関する制約または特殊なトランザクションセマンティクスがあります。 つまり、複数のテーブルの同時更新に対するトランザクションサポートが存在する場合がありますが、トランザクション中のテーブルの数と定義を変更することはできません。  
  
 アプリケーションは、SQL_TXN_CAPABLE オプションを指定して**SQLGetInfo**を呼び出すことによって、トランザクションがサポートされるかどうか、DDL をトランザクションに含めることができるかどうか、およびトランザクションに DDL を含める特殊効果を決定します。 詳細については[、SQLGetInfo](../../../odbc/reference/syntax/sqlgetinfo-function.md)関数の説明を参照してください。  
  
 ドライバーがトランザクションをサポートしていないが、アプリケーションが (ODBC 以外の API を使用して) データをロックおよびロック解除する機能を持っている場合、アプリケーションは必要に応じてレコードとテーブルをロックおよびロック解除することで、トランザクションのサポートを実現できます。 勘定振替の例を実装するには、アプリケーションは両方の勘定のレコードをロックし、現在の値をコピーし、最初の勘定を借方記入し、2 番目の勘定を貸方記入し、レコードのロックを解除します。 いずれかの手順が失敗した場合、アプリケーションはコピーを使用してアカウントをリセットします。  
  
 トランザクションをサポートするデータ ソースでも、特定の環境内で一度に複数のトランザクションをサポートできない場合があります。 アプリケーションは **、sqlGetInfo**を SQL_MULTIPLE_ACTIVE_TXN オプション付きで呼び出して、同じ環境内の複数の接続で同時アクティブなトランザクションをデータ ソースがサポートできるかどうかを判断します。 接続ごとに 1 つのトランザクションが存在するため、同じデータ ソースに対して複数の接続を持つアプリケーションに対してのみ興味深い方法です。
