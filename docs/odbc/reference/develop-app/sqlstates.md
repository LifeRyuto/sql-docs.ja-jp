---
title: SQL スタテス |マイクロソフトドキュメント
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- diagnostic information [ODBC], sqlstates
- SQLSTATE [ODBC]
ms.assetid: f29fff2e-3d09-4a8c-a2f9-2059062cbebf
author: David-Engel
ms.author: v-daenge
ms.openlocfilehash: be4bca929b8d48c301c6e71917503387004a6ec5
ms.sourcegitcommit: ce94c2ad7a50945481172782c270b5b0206e61de
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/14/2020
ms.locfileid: "81299729"
---
# <a name="sqlstates"></a>SQLSTATE
SQLSTATE は、警告またはエラーの原因に関する詳細情報を提供します。 このマニュアルの SQLSTATE は、ISO/IEF CLI 仕様に記載されている SQLSTATE に基づいていますが、IM で始まる SQLSTATE は ODBC に固有のものです。  
  
 戻りコードとは異なり、このマニュアルの SQLSTATE はガイドラインであり、ドライバーは戻す必要はありません。 したがって、ドライバーは、検出可能なエラーまたは警告に対して適切な SQLSTATE を返す必要がありますが、アプリケーションは常にこの問題が発生することを考慮しないでください。 この状況の理由は、次の 2 つです。  
  
-   **不完全性**このマニュアルでは、多数のエラーと警告、およびそれらのエラーと警告の考えられる原因をリストしていますが、完全ではなく、おそらく決してありません。ドライバの実装は、単に多くの異なっています。 ドライバは、おそらくこのマニュアルに記載されているSQLSTATEsのすべてを返すものではなく、このマニュアルに記載されていないSQLSTATEsを返す可能性があります。  
  
-   **複雑さ**一部のデータベース エンジン (特にリレーショナル データベース エンジン) は、文字通り何千ものエラーと警告を返します。 このようなエンジンのドライバは、これらのエラーと警告のすべてが SQLSTATEs にマッピングされる可能性は低いのは、関係する作業、マッピングの正確性、結果のコードのサイズが大きく、結果のコードの値が低く、実行時に発生してはならないプログラミング エラーを返すことがよくあります。 したがって、ドライバーは妥当と思われる数のエラーと警告をマップし、SQLSTATE 01004 (データが切り捨てられる) などのアプリケーション ロジックの基になる可能性があるエラーと警告をマップする必要があります。  
  
 SQLSTATE は確実に返されないため、ほとんどのアプリケーションは、ユーザーに対して、関連する診断メッセージと共に表示するだけです。 アプリケーションは、ほとんどの SQLSTATE に基づいてプログラミング ロジックを作成できないため、この操作を行う際に機能が失われることはほとんどありません。 たとえば **、SQLExecDirect が**SQLSTATE 42000 (構文エラーまたはアクセス違反) を返したとします。 このエラーの原因となった SQL ステートメントがハードコーディングされているか、アプリケーションによってビルドされた場合、これはプログラミング エラーであり、コードを修正する必要があります。 ユーザーが SQL ステートメントを入力した場合、これはユーザー・エラーであり、アプリケーションはユーザーに問題を通知することによって可能なすべてを行っています。  
  
 アプリケーションが SQLSTATE に基づいてプログラミング・ロジックを実行する場合、SQLSTATE が戻されないか、または別の SQLSTATE が戻されるように準備する必要があります。 どの SQLSTATE が確実に返されるかは、多数のドライバーの経験に基づいてのみ行えます。 ただし、一般的なガイドラインでは、データ ソースではなく、ドライバーまたはドライバー マネージャーで発生するエラーの SQLSTATE が確実に返される可能性が高いということです。 たとえば、ほとんどのドライバーは、おそらく SQLSTATE HYC00 (オプション機能が実装されていません) を返しますが、SQLSTATE 42021 (列は既に存在) を返すドライバーが少ないです。  
  
 次の SQLSTATE は、実行時のエラーまたは警告を示し、プログラミングロジックの基礎となる有力な候補です。 ただし、すべてのドライバーがドライバーを返す保証はありません。  
  
-   01004 (データが切り捨てられました)  
  
-   01S02 (オプション値が変更されました)  
  
-   HY008 (操作がキャンセルされました)  
  
-   HYC00(オプション機能は実装されていません)  
  
-   HYT00 (タイムアウトの期限が切れています)  
  
 SQLSTATE HYC00 (オプション機能が実装されていません) は、アプリケーションが特定のステートメントまたは接続属性をサポートするかどうかをアプリケーションが判断する唯一の方法であるため、特に重要です。  
  
 SQLSTATE の完全なリストと、それらとそれらを返す関数については、「[付録 A: ODBC エラー コード](../../../odbc/reference/appendixes/appendix-a-odbc-error-codes.md)」を参照してください。 各関数が特定の SQLSTATE を戻す可能性がある条件の詳細については、その関数を参照してください。
