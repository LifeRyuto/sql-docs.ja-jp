---
title: トランザクション ODBC |マイクロソフトドキュメント
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- transactions [ODBC], about transactions
- transactions [ODBC]
ms.assetid: b4ca861a-c164-4e87-8672-d5de15e3823c
author: David-Engel
ms.author: v-daenge
ms.openlocfilehash: a40c34b2abeb346c7a718994ba2484bfc728e2b1
ms.sourcegitcommit: ce94c2ad7a50945481172782c270b5b0206e61de
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/14/2020
ms.locfileid: "81297957"
---
# <a name="transactions-odbc"></a>トランザクション (ODBC)
*トランザクション*は、単一のアトミック操作として実行される作業単位です。つまり、操作は全体として成功または失敗します。 たとえば、ある銀行口座から別の銀行口座に送金することを検討します。 これには、最初の口座からお金を引き出し、2番目の口座に入金するという2つのステップが含まれます。 両方のステップが成功することが重要です。一方のステップが成功し、もう一方のステップが失敗しても受け入れられません。 トランザクションをサポートするデータベースは、これを保証できます。  
  
 トランザクションは、*コミット*中または*ロールバック*によって完了できます。 トランザクションがコミットされると、そのトランザクションで行われた変更は永続的になります。 トランザクションがロールバックされると、影響を受ける行は、トランザクションが開始される前の状態に戻されます。 アカウント転送の例を拡張するには、アプリケーションは 1 つの SQL ステートメントを実行して最初の勘定を借方にし、別の SQL ステートメントを実行して 2 番目の口座を貸方記入します。 両方のステートメントが成功すると、アプリケーションはトランザクションをコミットします。 しかし、いずれかのステートメントが何らかの理由で失敗した場合、アプリケーションはトランザクションをロールバックします。 どちらの場合も、アプリケーションはトランザクションの終了時に一貫性のある状態を保証します。  
  
 1 つのトランザクションは、異なる時間に発生する複数のデータベース操作を含むことができます。 他のトランザクションが中間結果に完全にアクセスできる場合、トランザクションが互いに干渉する可能性があります。 たとえば、あるトランザクションが行を挿入し、2 番目のトランザクションがその行を読み取り、最初のトランザクションがロールバックされるとします。 2 番目のトランザクションには、存在しない行のデータが含まれるようになりました。  
  
 この問題を解決するために、トランザクションを分離するためのさまざまなスキームがあります。 *トランザクションの分離*は、一般に行をロックすることによって実装され、複数のトランザクションが同時に同じ行を使用することができなくなります。 データベースによっては、行をロックすると、他の行もロックされる場合があります。  
  
 トランザクション分離の増加に伴い *、同時実行性*が低下したり、2 つのトランザクションが同時に同じデータを使用する能力が低下したりします。 詳細については、「[トランザクション分離レベルの設定](../../../odbc/reference/develop-app/setting-the-transaction-isolation-level.md)」を参照してください。  
  
 このセクションでは、次のトピックを扱います。  
  
-   [ODBC でのトランザクション](../../../odbc/reference/develop-app/transactions-in-odbc-odbc.md)  
  
-   [トランザクション分離](../../../odbc/reference/develop-app/transaction-isolation.md)  
  
-   [同時実行制御](../../../odbc/reference/develop-app/concurrency-control.md)
