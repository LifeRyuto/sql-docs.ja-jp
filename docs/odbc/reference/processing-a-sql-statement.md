---
title: SQL ステートメントの処理 |マイクロソフトドキュメント
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- sending SQL statements to DBMS [ODBC]
- SQL statements [ODBC], processing
- SQL [ODBC], processing statements
- statement processing [ODBC]
- SQL statements [ODBC]
- ODBC [ODBC], SQL
ms.assetid: 96270c4f-2efd-4dc1-a985-ed7fd5658db2
author: David-Engel
ms.author: v-daenge
ms.openlocfilehash: 349a62034d598c1bfb44b891b91359d5ff184b7e
ms.sourcegitcommit: ce94c2ad7a50945481172782c270b5b0206e61de
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/14/2020
ms.locfileid: "81280522"
---
# <a name="processing-a-sql-statement"></a>SQL ステートメントの処理
SQL をプログラムで使用する手法について説明する前に、SQL ステートメントの処理方法について説明する必要があります。 関連する手順は 3 つのテクニックすべてに共通していますが、各手法は異なる時間に実行されます。 次の図は、このセクションの残りの部分で説明されている SQL ステートメントの処理に関連する手順を示しています。  
  
 ![SQL ステートメントの処理手順](../../odbc/reference/media/pr01.gif "pr01")  
  
 SQL ステートメントを処理するために、DBMS は次の 5 つのステップを実行します。  
  
1.  DBMS は、まず SQL ステートメントを解析します。 このステートメントはトークンと呼ばれる個々の単語に分割され、ステートメントに有効な動詞と有効な句が含まれるようにします。 この手順では、構文エラーやスペルミスを検出できます。  
  
2.  DBMS は、ステートメントを検証します。 このステートメントは、システム カタログに対してチェックされます。 ステートメント内に指定されたすべてのテーブルがデータベースに存在しますか? すべての列が存在し、列名が明確になっていますか? ユーザーは、ステートメントを実行するために必要な権限を持っていますか? この手順では、特定の意味エラーを検出できます。  
  
3.  DBMS は、ステートメントのアクセス・プランを生成します。 アクセス・プランは、ステートメントを実行するために必要なステップのバイナリ表現です。これは、実行可能コードと同じ DBMS です。  
  
4.  DBMS はアクセス・プランを最適化します。 アクセス計画を実行するさまざまな方法を探ります。 インデックスを使用して検索を高速化できますか? DBMS はまず検索条件をテーブル A に適用してからテーブル B に結合する必要がありますか。 テーブルを順次検索を回避したり、テーブルのサブセットに縮小したりすることはできますか。 代替案を調べ、DBMSはそれらの1つを選択します。  
  
5.  DBMS は、アクセス・プランを実行してステートメントを実行します。  
  
 SQL ステートメントの処理に使用されるステップは、必要なデータベース・アクセスの量と、必要な時間によって異なります。 SQL ステートメントの解析では、データベースへのアクセスは必要なものではなく、非常に迅速に実行できます。 一方、最適化は非常に CPU を消費するプロセスであり、システム カタログへのアクセスが必要です。 複雑な複数のクエリの場合、オプティマイザは同じクエリを実行する何千もの異なる方法を探索することがあります。 ただし、クエリを非効率的に実行するコストは通常非常に高いため、最適化に費やされる時間はクエリ実行速度の向上に費やされる以上の時間になります。 同じ最適化されたアクセス プランを繰り返しクエリを実行するために何度も使用できる場合、これはさらに重要です。
