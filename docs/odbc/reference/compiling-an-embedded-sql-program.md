---
title: 組み込み SQL プログラムのコンパイル |マイクロソフトドキュメント
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- SQL [ODBC], embedded SQL
- SQL statements [ODBC], embedded SQL
- compiling embedded SQL programs [ODBC]
- embedded SQL [ODBC]
ms.assetid: 9e94146a-5b80-4a01-b586-1e03ff05b9ac
author: David-Engel
ms.author: v-daenge
ms.openlocfilehash: eb801dc532009410055b67031b3e036cc6b9c3d0
ms.sourcegitcommit: ce94c2ad7a50945481172782c270b5b0206e61de
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/14/2020
ms.locfileid: "81306533"
---
# <a name="compiling-an-embedded-sql-program"></a>埋め込み SQL プログラムのコンパイル
組み込み SQL プログラムには SQL ステートメントとホスト言語ステートメントが混在しているため、ホスト言語用のコンパイラーに直接サブミットすることはできません。 代わりに、複数のステップのプロセスを通じてコンパイルされます。 このプロセスは製品によって異なりますが、すべての製品で手順はほぼ同じです。  
  
 この図は、組み込み SQL プログラムのコンパイルに必要な手順を示しています。  
  
 ![埋め込み SQL プログラムのコンパイル手順](../../odbc/reference/media/pr02.gif "pr02")  
  
 組み込み SQL プログラムのコンパイルには、次の 5 つのステップが関係します。  
  
1.  組み込み SQL プログラムは、プログラミング・ツールである SQL プリコンパイラーに送信されます。 プリコンパイラーはプログラムをスキャンし、組み込み SQL ステートメントを検出して処理します。 DBMS でサポートされるプログラミング言語ごとに、異なるプリコンパイラーが必要です。 DBMS 製品は、通常、C、パスカル、COBOL、フォートラン、エイダ、PL/I、およびさまざまなアセンブリ言語を含む 1 つ以上の言語のプリコンパイラを提供します。  
  
2.  プリコンパイラーは、2 つの出力ファイルを生成します。 最初のファイルはソース・ファイルで、組み込み SQL ステートメントが除去されます。 プリコンパイラは、プログラムと DBMS の間の実行時リンクを提供する独自の DBMS ルーチンの呼び出しを置き換えます。 通常、これらのルーチンの名前と呼び出しシーケンスは、プリコンパイラーと DBMS にのみ認識されます。これらは、DBMS へのパブリック インターフェイスではありません。 2 番目のファイルは、プログラムで使用されるすべての組み込み SQL ステートメントのコピーです。 このファイルは、データベース要求モジュールまたは DBRM と呼ばれることもあります。  
  
3.  プリコンパイラーからのソース・ファイル出力は、ホスト・プログラミング言語 (C コンパイラーまたは COBOL コンパイラーなど) の標準コンパイラーに送信されます。 コンパイラはソース コードを処理し、オブジェクト コードを出力として生成します。 この手順は、DBMS や SQL とは関係ありません。  
  
4.  リンカーは、コンパイラによって生成されたオブジェクト・モジュールを受け入れ、それらをさまざまなライブラリー・ルーチンとリンクさせ、実行可能プログラムを生成します。 実行可能プログラムにリンクされたライブラリ ルーチンには、手順 2 で説明されている独自の DBMS ルーチンが含まれます。  
  
5.  プリコンパイラーによって生成されたデータベース要求モジュールは、特殊バインディング・ユーティリティーに送信されます。 このユーティリティーは、SQL ステートメントを検査し、構文解析し、妥当性検査を行い、最適化してから、各ステートメントのアクセス・プランを作成します。 結果は、プログラム全体の結合アクセス・プランとなり、組み込み SQL ステートメントの実行可能バージョンを表します。 バインディング・ユーティリティーは、通常、それを使用するアプリケーション・プログラムの名前を割り当てて、データベースにプランを保管します。 このステップがコンパイル時に実行されるか、実行時に実行されるかは、DBMS によって異なります。  
  
 組み込み SQL プログラムのコンパイルに使用するステップは[、「SQL ステートメントの処理](../../odbc/reference/processing-a-sql-statement.md)」で説明した手順と非常に密接に関連していることに注意してください。 特に、プリコンパイラーが SQL ステートメントをホスト言語コードから分離し、バインディング・ユーティリティーが SQL ステートメントを解析および検証し、アクセス・プランを作成します。 コンパイル時にステップ 5 が実行される DBMS では、SQL ステートメントを処理する最初の 4 つのステップがコンパイル時に実行され、最後のステップ (実行) が実行時に実行されます。 これは、このような DBMS でのクエリ実行を非常に高速にする効果があります。
