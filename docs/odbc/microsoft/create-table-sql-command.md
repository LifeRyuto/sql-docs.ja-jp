---
title: テーブルの作成 - SQL コマンド |マイクロソフトドキュメント
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- CREATE TABLE [ODBC]
ms.assetid: be2143ba-fc16-42c9-84f7-8985cd924860
author: David-Engel
ms.author: v-daenge
ms.openlocfilehash: dfc80a56a021b1bfeda38115e79f7086632900c8
ms.sourcegitcommit: ce94c2ad7a50945481172782c270b5b0206e61de
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/14/2020
ms.locfileid: "81298692"
---
# <a name="create-table---sql-command"></a>CREATE TABLE - SQL コマンド
指定したフィールドを持つテーブルを作成します。  
  
 ビジュアル フォックスプロ ODBC ドライバーは、このコマンドのネイティブの Visual FoxPro 言語構文をサポートしています。 ドライバ固有の情報については、「**ドライバ解説**」を参照してください。  
  
## <a name="syntax"></a>構文  
  
```  
  
CREATE TABLE | DBF TableName1 [NAME LongTableName] [FREE]  
   (FieldName1FieldType [(nFieldWidth [, nPrecision])]  
      [NULL | NOT NULL]   
      [CHECK lExpression1 [ERROR cMessageText1]]  
      [DEFAULT eExpression1]  
      [PRIMARY KEY | UNIQUE]  
      [REFERENCES TableName2 [TAG TagName1]]  
      [NOCPTRANS]  
   [, FieldName2 ...]  
      [, PRIMARY KEY eExpression2 TAG TagName2  
      |, UNIQUE eExpression3 TAG TagName3]  
      [, FOREIGN KEY eExpression4 TAG TagName4 [NODUP]  
            REFERENCES TableName3 [TAG TagName5]]  
      [, CHECK lExpression2 [ERROR cMessageText2]])  
| FROM ARRAY ArrayName  
```  
  
## <a name="arguments"></a>引数  
 DBF*テーブル名 1 &#124;テーブルの*作成  
 作成するテーブルの名前を指定します。 TABLE オプションと DBF オプションは同じです。  
  
 名前*ロングテーブル名*  
 テーブルの長い名前を指定します。 長いテーブル名はデータベースに格納されるため、データベースが開いているときにだけ長いテーブル名を指定できます。  
  
 長い名前は最大 128 文字まで使用でき、データベース内の短いファイル名の代わりに使用できます。  
  
 FREE  
 開いているデータベースにテーブルを追加しないことを指定します。 データベースが開いていない場合は、FREE は必要ありません。  
  
 *(フィールド名1 フィールドタイプ* *[(n フィールド幅*[, *nprecision*])]  
 フィールド名、フィールドの種類、フィールドの幅、およびフィールドの精度 (小数点以下の桁数) をそれぞれ指定します。  
  
 *FieldType*はフィールドの[データ型](../../odbc/microsoft/visual-foxpro-field-data-types.md)を示す 1 文字の文字です。 一部のフィールド データ型では *、nFieldWidth*または*nPrecision*またはその両方を指定する必要があります。  
  
 *Nフィールド幅*と*nPrecision*は、D、G、I、L、M、P、T、および Y 型では無視されます。 *nPrecision が*B、F、N 型に含*まれていない場合、* デフォルトでは 0 (小数点以下の桁数なし) になります。  
  
 NULL  
 フィールド内の NULL 値を許可します。  
  
 NOT NULL  
 フィールド内の NULL 値を防ぎます。  
  
 NULL と NOT NULL を省略すると、現在の SET NULL の設定によって、フィールドに NULL 値を使用できるかどうかが決まります。 ただし、NULL と NOT NULL を省略し、主キーまたは UNIQUE 句を含める場合、SET NULL の現在の設定は無視され、フィールドの既定値は NOT NULL になります。  
  
 チェック*l 式1*  
 フィールドの入力規則を指定します。 *lExpression1*は、ユーザー定義関数にできます。 空白のレコードが追加されると、入力規則がチェックされます。 入力規則で追加されたレコードの空白のフィールド値が許可されていない場合、エラーが生成されます。  
  
 エラー*メッセージテキスト1*  
 フィールド ルールでエラーが生成されたときに表示されるエラー メッセージを指定します。 このメッセージは、参照ウィンドウまたは編集ウィンドウ内でデータが変更された場合にのみ表示されます。  
  
 既定*の e 式1*  
 フィールドの既定値を指定します。 *eExpression1*のデータ型は、フィールドのデータ型と同じである必要があります。  
  
 PRIMARY KEY  
 フィールドのプライマリ インデックスを作成します。 プライマリ インデックス タグの名前は、フィールドと同じです。  
  
 UNIQUE  
 フィールドの候補インデックスを作成します。 候補インデックス タグの名前は、フィールドと同じです。  
  
> [!NOTE]  
>  候補索引 (CREATE TABLE または ALTER TABLE - SQL に UNIQUE オプションを組み込んだ場合に作成される) は、INDEX コマンドで UNIQUE オプションを使用して作成された索引とは異なります。 INDEX コマンドで UNIQUE オプションを使用して作成された索引は、重複する索引キーを許可します。候補インデックスでは、重複するインデックス キーは許可されません。 固有オプションの追加情報については[、INDEX](../../odbc/microsoft/index-command.md)を参照してください。  
  
 NULL 値および重複レコードは、プライマリインデックスまたは候補インデックスに使用されるフィールドでは許可されません。 ただし、Null 値をサポートするフィールドのプライマリインデックスまたは候補インデックスを作成した場合、Visual FoxPro はエラーを生成しません。 プライマリインデックスまたは候補インデックスに使用されるフィールドに NULL 値または重複する値を入力しようとすると、Visual FoxPro エラーが生成されます。  
  
 参照*テーブル名2*[*タグ名1]*  
 永続的な関係が確立される親テーブルを指定します。 TAG *TagName1*を省略すると、親テーブルのプライマリ インデックス キーを使用してリレーションシップが確立されます。 親テーブルにプライマリ インデックスがない場合、Visual FoxPro はエラーを生成します。  
  
 親テーブルの既存のインデックス タグに基づいてリレーションシップを確立するには *、TAG TagName1*を含めます。 インデックス タグ名には、最大 10 文字を使用できます。  
  
 親テーブルを空きテーブルにすることはできません。  
  
 ノCPトランス  
 文字フィールドとメモ型フィールドの別のコード ページへの変換を禁止します。 表が別のコード・ページに変換される場合、NOCPTRANS が指定されているフィールドは変換されません。 NOCPTRANS は、文字フィールドおよびメモ・フィールドに対してのみ指定できます。  
  
 次の例では、2 つの文字フィールドと 2 つのメモ型フィールドを含む mytable という名前のテーブルを作成します。 2 番目の文字フィールド char2 と 2 番目のメモフィールド memo2 には、変換を防止するために NOCPTRANS が含まれています。  
  
```  
CREATE TABLE mytable (char1 C(10), char2 C(10) NOCPTRANS,;  
   memo1 M, memo2 M NOCPTRANS)  
```  
  
 主キー *eExpression2* *タグタグ名2*  
 作成するプライマリ インデックスを指定します。 *eExpression2*は、テーブル内のフィールドまたはフィールドの組み合わせを指定します。 TAG *TagName2*は、作成されるプライマリ インデックス タグの名前を指定します。 インデックス タグ名には、最大 10 文字を使用できます。  
  
 テーブルには 1 つのプライマリ インデックスしか含めることができないため、フィールドに対して既にプライマリ インデックスを作成している場合は、この句を含めることはできません。 CREATE TABLE に複数のプライマリ キー句を含める場合、エラーが生成されます。  
  
 一意*の表現3**タグタグ名3*  
 候補インデックスを作成します。 *eExpression3*は、テーブル内の任意のフィールドまたはフィールドの組み合わせを指定します。 ただし、PRIMARY KEY オプションのいずれかを指定してプライマリ インデックスを作成した場合は、プライマリ インデックスに指定されたフィールドを含めることはできません。 TAG *TagName3 は*、作成される候補インデックス タグのタグ名を指定します。 インデックス タグ名には、最大 10 文字を使用できます。  
  
 1 つのテーブルに複数の候補インデックスを指定できます。  
  
 外部キー*式4*タグ*名4*[NODUP]  
 外部 (非プライマリ) インデックスを作成し、親テーブルとのリレーションシップを確立します。 *eExpression4*は外部インデックス キー式を指定し *、TagName4*は作成される外部インデックス キー タグの名前を指定します。 インデックス タグ名には、最大 10 文字を使用できます。 候補の外部インデックスを作成するには、NODUP を含めます。  
  
 テーブルに対して複数の外部インデックスを作成できますが、外部インデックス式ではテーブル内で異なるフィールドを指定する必要があります。  
  
 参照*テーブル名3*[*タグ名5]*  
 永続的な関係が確立される親テーブルを指定します。 親テーブルのインデックス タグに基づいてリレーションシップを確立するには *、TAG TagName5*を含めます。 インデックス タグ名には、最大 10 文字を使用できます。 デフォルトでは、TAG *TagName5*を省略すると、親テーブルの主インデックスキーを使用してリレーションシップが確立されます。  
  
 チェック*e エクスプレッション 2*[エラー *cMessageText2]*  
 テーブルの入力規則を指定します。 エラー *cMessageText2*は、テーブルの検証規則が実行されたときに Visual FoxPro が表示するエラー メッセージを指定します。 このメッセージは、参照ウィンドウまたは編集ウィンドウ内でデータが変更された場合にのみ表示されます。  
  
 配列*配列名から*  
 テーブルの各フィールドの名前、型、有効桁数、および小数点以下桁数を内容とする既存の配列の名前を指定します。 配列の内容は**AFIELDS**( ) 関数で定義できます。  
  
## <a name="remarks"></a>解説  
 新しいテーブルは、使用可能な最低の作業領域で開かれ、その別名でアクセスできます。 新しいテーブルは、SET EXCLUSIVE の現在の設定に関係なく、排他的に開かれます。  
  
 データベースが開いていて FREE 句を含めなければ、新しいテーブルがデータベースに追加されます。 データベース内のテーブルと同じ名前の新しいテーブルを作成することはできません。  
  
 データベースが開いている場合、CREATE TABLE - SQL はデータベースを排他的に使用する必要があります。 排他的に使用するデータベースを開くには、データベースを開く中に EXCLUSIVE を含めます。  
  
 新しいテーブルを作成するときにデータベースが開いていない場合は、名前、チェック、デフォルト、外部キー、主キー、または REFERENCES 句を含む、エラーが生成されます。  
  
> [!NOTE]  
>  CREATE TABLE 構文では、特定の CREATE TABLE オプションを区切るためにコンマを使用します。 また、NULL、NOT NULL、チェック、デフォルト、プライマリ・キー、および UNIQUE 句は、列定義を含む括弧の中に入れなければなりません。  
  
## <a name="driver-remarks"></a>ドライバの解説  
 アプリケーションが ODBC SQL ステートメント CREATE TABLE をデータ ソースに送信すると、次の表に示す構文を使用して、コマンドが Visual FoxProCREATE TABLE コマンドに変換されます。  
  
|ODBC 構文|ビジュアル フォックスプロの構文|  
|-----------------|--------------------------|  
|テーブル*の作成 ベース テーブル名*<br /><br /> (*列識別子のデータ型*<br /><br /> [NULL ではない]<br /><br /> [,*列識別子データ型*<br /><br /> [ヌルではありません] .)|テーブル*名を作成する1* [名前*ロングテーブル名*]<br /><br /> (*フィールド名1* *フィールドタイプ*<br /><br /> *[(nフィールド幅**[nPrecision])]*<br /><br /> [NULLではない])|  
  
 ドライバーを使用してテーブルを作成すると、ドライバーは、他のユーザーがテーブルへのアクセスを許可する作成後すぐにテーブルを閉じます。 これは、作成時にテーブルを排他的に開いたままにするビジュアル FoxPro とは異なります。 ただし、CREATE TABLE ステートメントを含むデータ ソースのストアド プロシージャが実行された場合、テーブルは開いたままになります。  
  
 データ ソースがデータベース (.dbc ファイル) の場合、Visual FoxPro ODBC ドライバーは、ベース テーブル名と同じ名前の*LongTableName*という名前*のテーブル*を作成します。  
  
### <a name="using-data-definition-language-ddl"></a>データ定義言語 (DDL) の使用  
 DDL は次の場所に含めることはできません。  
  
-   トランザクションを必要とするバッチ SQL ステートメント内  
  
-   手動コミット モードでは、トランザクションを必要とするステートメントの後に、アプリケーションが最初に**SQLTransact**を呼び出す場合を除きます。  
  
 たとえば、一時テーブルを作成する場合は、トランザクションを必要とするステートメントを開始する前にテーブルを作成する必要があります。 トランザクションを必要とするバッチ SQL ステートメントに CREATE TABLE ステートメントを含める場合、ドライバーはエラー メッセージを返します。  
  
## <a name="see-also"></a>参照  
 [テーブルの変更 - SQL コマンド](../../odbc/microsoft/alter-table-sql-command.md)   
 [サポートされているデータ型 (ビジュアル フォックスプロ ODBC ドライバー)](../../odbc/microsoft/supported-data-types-visual-foxpro-odbc-driver.md)   
 [挿入 - SQL コマンド](../../odbc/microsoft/insert-sql-command.md)   
 [SELECT - SQL コマンド](../../odbc/microsoft/select-sql-command.md)
