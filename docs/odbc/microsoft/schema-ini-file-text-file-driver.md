---
title: スキーマ.iniファイル(テキストファイルドライバ) |マイクロソフトドキュメント
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- schema.ini file [ODBC]
- text file driver [ODBC], schema.ini file
ms.assetid: 0c4625c4-c730-4984-b430-9051b7bc0451
author: David-Engel
ms.author: v-daenge
ms.openlocfilehash: 365351724f27205e7d460c757f1268d042cefc76
ms.sourcegitcommit: ce94c2ad7a50945481172782c270b5b0206e61de
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/14/2020
ms.locfileid: "81305513"
---
# <a name="schemaini-file-text-file-driver"></a>Schema.ini ファイル (テキスト ファイル ドライバー)
テキスト ドライバーを使用する場合、テキスト ファイルの形式は、スキーマ情報ファイルを使用して決定されます。 スキーマ情報ファイルは、常に Schema.ini という名前で、常にテキスト データ ソースと同じディレクトリに保持されます。 スキーマ情報ファイルは、IISAM に、ファイルの一般的な形式、列名とデータ型の情報、およびその他のデータ特性に関する情報を提供します。 固定長データにアクセスするためには、常に Schema.ini ファイルが必要です。 テキスト テーブルに DateTime、通貨、または 10 進数のデータが含まれている場合、またはテーブル内のデータの処理をより詳細に制御する必要がある場合は、Schema.ini ファイルを使用する必要があります。  
  
> [!NOTE]  
>  テキスト ISAM は Schema.ini からではなく、レジストリから初期値を取得します。 すべての新しいテキスト データ テーブルに同じ既定のファイル形式が適用されます。 CREATE TABLE ステートメントによって作成されたすべてのファイルは、**テーブル**リストで選択された\<既定の>を使用して、[**テキスト形式の定義**] ダイアログ ボックスでファイル形式の値を選択して設定される、同じ既定のフォーマット値を継承します。 レジストリの値が Schema.ini の値と異なる場合、レジストリ内の値は Schema.ini の値で上書きされます。  
  
## <a name="understanding-schemaini-files"></a>スキーマ.iniファイルについて  
 Schema.ini ファイルは、テキスト ファイル内のレコードに関するスキーマ情報を提供します。 各 Schema.ini エントリは、テーブルの 5 つの特性のいずれかを指定します。  
  
-   テキスト ファイル名  
  
-   ファイル形式  
  
-   フィールド名、幅、およびタイプ  
  
-   文字セット  
  
-   特殊なデータ型変換  
  
 以下のセクションでは、これらの特性について説明します。  
  
## <a name="specifying-the-file-name"></a>ファイル名の指定  
 Schema.ini の最初のエントリは、常にテキスト ソース ファイルの名前を角かっこで囲んだ名前です。 次の例は、Sample.txt ファイルのエントリを示しています。  
  
```  
[Sample.txt]  
```  
  
## <a name="specifying-the-file-format"></a>ファイル形式の指定  
 Schema.ini の **[書式**] オプションでは、テキスト ファイルの形式を指定します。 テキスト IISAM は、ほとんどの文字区切りファイルから自動的にフォーマットを読み取ることができます。 ファイル内では、二重引用符 (") 以外の区切り文字として任意の 1 文字を使用できます。 Schema.ini の **[フォーマット]** 設定は、ファイルごとに Windows レジストリの設定を上書きします。 次の表は **、Format**オプションの有効な値を示しています。  
  
|書式指定子|表形式|スキーマ.ini 形式ステートメント|  
|----------------------|------------------|---------------------------------|  
|**タブ区切り**|ファイル内のフィールドはタブで区切られます。|フォーマット=タブ区切り|  
|**CSV 区切り**|ファイル内のフィールドは、コンマ (コンマ区切り値) で区切られます。|形式=CSV区切り文字|  
|**カスタム区切り**|ファイル内のフィールドは、ダイアログ ボックスに入力する文字で区切られます。 二重引用符 (") 以外はすべて、ブランクも含めて許可されます。|フォーマット=区切り(*カスタム文字*)<br /><br /> \- または -<br /><br /> 区切り文字を指定しない場合:<br /><br /> 形式=区切り記号( )|  
|**固定長**|ファイル内のフィールドの長さは固定です。|形式 =固定長|  
  
## <a name="specifying-the-fields"></a>フィールドの指定  
 文字区切りテキスト ファイルでフィールド名を指定するには、次の 2 つの方法があります。  
  
-   テーブルの最初の行にフィールド名を含め **、ColNameHeader**を True に設定**します。**  
  
-   各列を番号で指定し、列名とデータ型を指定します。  
  
 各列は、番号で指定し、固定長ファイルの列名、データ型、および幅を指定する必要があります。  
  
> [!NOTE]  
>  Schema.ini の**ColNameHeader**設定は、ファイルごとに Windows レジストリの**FirstRowHasNames**設定をオーバーライドします。  
  
 フィールドのデータ型も決定できます。 列の種類を決定するときにスキャンする行数を指定するには **、MaxScanRows**オプションを使用します。 **MaxScanRows を**0 に設定すると、ファイル全体がスキャンされます。 Schema.ini の**MaxScanRows 設定**は、ファイルごとに Windows レジストリの設定をオーバーライドします。  
  
 次のエントリは、Jet がフィールド名を決定するためにテーブルの最初の行のデータを使用し、使用するデータ型を決定するファイル全体を調べる必要があることを示します。  
  
```  
ColNameHeader=True  
MaxScanRows=0  
```  
  
 次のエントリは、列番号 (**Col**_n_) オプションを使用してテーブルのフィールドを指定します。 この例では、2 つのフィールドの Schema.ini エントリ (10 文字の CustomerNumber テキスト フィールドと 30 文字の CustomerName テキスト フィールド) を示します。  
  
```  
Col1=CustomerNumber Text Width 10  
Col2=CustomerName Text Width 30  
```  
  
 **Col**_n_の構文は次のとおりです。  
  
```  
  
n=ColumnNametype [#]  
```  
  
## <a name="remarks"></a>解説  
 次の表は **、Col**_n_エントリの各部分について説明しています。  
  
|パラメーター|説明|  
|---------------|-----------------|  
|*[ColumnName]*|列のテキスト名。 列名にスペースが埋め込まれている場合は、二重引用符で囲む必要があります。|  
|*type*|データ型は次のとおりです。<br /><br /> **マイクロソフトジェットのデータ型**<br /><br /> bit<br /><br /> Byte<br /><br /> Short<br /><br /> Long<br /><br /> Currency<br /><br /> Single<br /><br /> Double<br /><br /> DateTime<br /><br /> Text<br /><br /> メモ<br /><br /> **ODBC データ型**文字 (テキストと同じ)<br /><br /> フロート(ダブルと同じ)<br /><br /> 整数 (ショートと同じ)<br /><br /> ロングチャー (メモと同じ)<br /><br /> *日付の日付の形式*|  
|**Width**|リテラル文字列値`Width`。 次の数値が列の幅を指定することを示します (文字区切りファイルの場合は省略可能で、固定長ファイルでは必須)。|  
|*#*|列の幅を指定する整数値 **(Width**が指定されている場合は必須)。|  
  
## <a name="selecting-a-character-set"></a>文字セットの選択  
 ANSI と OEM の 2 つの文字セットから選択できます。 Schema.ini の**文字セット設定**は、ファイルごとに Windows レジストリの設定をオーバーライドします。 次の例は、文字セットを ANSI に設定する Schema.ini エントリを示しています。  
  
```  
CharacterSet=ANSI  
```  
  
## <a name="specifying-data-type-formats-and-conversions"></a>データ型の形式と変換の指定  
 Schema.ini ファイルには、データの変換や表示方法を指定するために使用できるオプションがいくつか含まれています。 次の表に、これらの各オプションを示します。  
  
|オプション|説明|  
|------------|-----------------|  
|**DateTimeFormat**|日付と時刻を示す書式指定文字列に設定できます。 インポート/エクスポートのすべての日付/時刻フィールドが同じ形式で処理される場合は、このエントリを指定する必要があります。 午前を除くすべてのマイクロソフトジェットフォーマット。 午後の時刻の がサポートされます。 書式指定文字列がない場合は、Windows コントロール パネルの短い日付の画像と時刻のオプションが使用されます。|  
|**小数点記号**|整数と数値の小数部を区切るために使用される任意の 1 文字に設定できます。|  
|**数字の桁**|数値の小数部の小数部の桁数を示します。|  
|**ナンバーリーディングゼロ**|1 より小さい 10 進数値と -1 より大きい 10 進値に先行ゼロを含めるかどうかを指定します。この値は、False (先行ゼロなし) または True のいずれかです。|  
|**CurrencySymbol**|テキスト ファイルの通貨値に使用できる通貨記号を示します。 たとえば、ドル記号 ($) と Dm が含まれます。|  
|**通貨ポスフォーマット**|次のいずれかの値を設定できます。<br /><br /> - 分離なしの通貨記号接頭辞 ($1)<br />- 分離なしの通貨記号接尾辞 (1$)<br />- 1 文字区切り ($ 1) を持つ通貨記号の接頭辞<br />- 1 文字区切り (1 $) を持つ通貨記号の接尾語|  
|**通貨桁数**|通貨金額の小数部に使用する桁数を指定します。|  
|**通貨ネグフォーマット**|次の値のいずれかです。<br /><br /> - ($1)<br />- -$1<br />- $-1<br />- $1-<br />- (1$)<br />- -1$<br />- 1-$<br />- 1$-<br />- -1 $<br />- -$ 1<br />- 1 $-<br />- $ 1-<br />- $ -1<br />- 1 - $<br />- ($ 1)<br />- (1 $)<br /><br /> この例ではドル記号を示していますが、実際のプログラムでは適切な**CurrencySymbol**値に置き換える必要があります。|  
|**通貨サウザンドシンボル**|テキスト ファイル内の通貨値を千単位で区切る際に使用できる 1 文字の記号を示します。|  
|**通貨小数点記号**|通貨金額の小数部分から全体を区切るために使用される任意の 1 文字に設定できます。|  
  
> [!NOTE]  
>  エントリを省略すると、Windows のコントロール パネルの既定値が使用されます。
