---
title: テキスト形式の定義 (テキスト ファイル ドライバ) |マイクロソフトドキュメント
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- text format [ODBC]
- text file driver [ODBC], text format
ms.assetid: 3af46dad-52cc-4d5c-a27e-6315d65a74e6
author: David-Engel
ms.author: v-daenge
ms.openlocfilehash: 29dc46525f3c81e5abffe5076988716a01df06df
ms.sourcegitcommit: ce94c2ad7a50945481172782c270b5b0206e61de
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/14/2020
ms.locfileid: "81307663"
---
# <a name="defining-text-format-text-file-driver"></a>テキスト形式の定義 (テキスト ファイル ドライバー)
テキスト ドライバーを使用する場合は、[**テキスト形式の定義**] ダイアログ ボックスを使用して、選択したファイルの列の形式を定義できます。 このダイアログ ボックスでは、各データ テーブルのスキーマを指定できます。 この情報は、データ ソース ディレクトリの Schema.ini ファイルに書き込まれます。 テキスト データ ソース ディレクトリごとに、別個の Schema.ini ファイルが作成されます。  
  
> [!NOTE]  
>  すべての新しいテキスト データ テーブルに同じ既定のファイル形式が適用されます。 CREATE TABLE ステートメントで作成されるすべてのファイルは、**テーブル**リストで選択された\<既定の>を使用して、[**テキスト形式の定義**] ダイアログ ボックスでファイル形式の値を選択することによって設定される、同じ既定のフォーマット値を継承します。 Text ドライバは、既存のテキスト ファイルの形式をこのダイアログ ボックスで定義した形式に変更しませんが、テキスト ファイルからデータを取得しようとした場合など、その形式を使用するとエラーが返されます。  
  
 [**文字書式の定義**]ダイアログ ボックスでは、次のオプションを使用できます。  
  
|オプション|Information|  
|------------|-----------------|  
|**追加**|ダイアログ ボックスの **[データ型**]、[**名前]、** および **[幅]** の値を使用して列を追加し、必要に応じて Schema.ini の日付区切り値を追加します。|  
|**文字**|**ANSI**または**OEM**. OEM は、ANSI 以外の文字セットを指定します。 [**テーブル]** ボックスで選択した項目の形式が、このダイアログ ボックスで以前に定義されていない場合、既定では OEM が使用されます。|  
|**列名ヘッダー**|選択したテーブルの最初の行の列を列名として使用するかどうかを示します。 **TRUE**または**FALSE**のいずれかです。 **[テーブル]** ボックスで選択した項目の書式が、このダイアログ ボックスで以前に定義されていない場合は、既定値は FALSE になります。|  
|**削除**|選択したテーブルの各列の列名を一覧表示します。 列の順序は、テーブル内の列の順序を反映します。 このリストは、**テーブル**リストでファイルが選択されている場合に有効になります。|  
|**[データ型]**|ビット、バイト、文字、通貨、日付、浮動小数、整数、長文字、ショート、またはシングルを指定できます。 日付データ型は、"dd-mmm-yy"、"mm-dd-yy"、"mmm-dd-yy"、"yyyy-mm-dd"、または "yyyy-mmm-dd" の形式で指定できます。 "mm" は月数を表します。「mmm」は数ヶ月の文字を表します。|  
|**区切り記号**|列を区切るために使用するカスタム区切り文字を指定します。 **[カスタム区切り形式**] が選択されている場合に有効になります。 区切り文字は長さが 1 文字のみで、二重引用符 (") は区切り文字として使用できません。 (区切り文字は 16 進数または 10 進形式では指定できません。|  
|**Format**|区切り文字または固定長。 区切り記号の場合は、使用する区切り文字の種類 (コンマ (CSV)、タブ、特殊文字 (カスタム) を示します。 **[テーブル]** ボックスで選択したアイテムの書式が、このダイアログ ボックスで以前に定義されていない場合、既定では**CSV で区切られます**。<br /><br /> **Format**が固定長で**列名ヘッダー**が TRUE の場合、最初の行はカンマ区切りでなければなりません。|  
|**推測**|[**書式**] ボックスの選択に従ってテーブルの内容をスキャンすることにより、選択したテーブルの列のデータ型、名前、および幅の値を自動的に生成します。 テーブル形式が区切られている場合に有効になります。 **[列]** リストで以前に定義した列はクリアされ、新しいエントリに置き換えられます。 **[列名ヘッダー]** を選択しない場合、列名は自動的に "F1" や "F2" として生成されます。 [**データ型]** ボックスには既定値は表示されません。<br /><br /> この機能は、64,513 バイト未満の列でのみ機能します。|  
|**Modify**|[**データ型**]、[**名前 ]**、および **[ 幅**] の値を使用して、選択した列を変更します。|  
|**名前**|選択した列の名前を表示します。 既存の列または新しい列の新しい列名を指定するために使用できます。<br /><br /> **列名ヘッダー**が TRUE の場合、表示される列名は無視されます。|  
|**削除**|選択した列を削除します。|  
|**スキャンする行**|既存のデータに基づいて列と列のデータ型を設定するときに、セットアップまたはドライバーがスキャンする行の数。<br /><br /> スキャンする行数には、1 から 32767 までの数値を入力できます。 **[テーブル]** ボックスで選択した項目の書式が、このダイアログ ボックスで以前に定義されていない場合、既定値は 25 です。 (制限を超えた数値はエラーを返します。|  
|**テーブル**|[**テキスト セットアップ]** ダイアログ ボックスで選択したディレクトリ内のファイルのうち、指定した拡張子の一覧に一致するファイルの一覧が表示されます。<br /><br /> デフォルト\<>が選択され、次のいずれかが真である場合、**テーブル**グループのテーブル属性の値が Schema.ini に書き込まれます (Schema.ini の他のエントリはアクセスされません)。<br /><br /> - 指定されたディレクトリに Schema.ini がありません。<br />- Schema.ini ファイルは存在しますが、ディレクトリ内のテキスト ファイル (指定された拡張子を持つ) の 1 つに対するセクションが Schema.ini にありません。<br />- テキスト ファイルのセクションは Schema.ini に存在しますが、本文は空です。<br /><br /> 既定\<の>を選択すると、[**列]** グループは無効になります。|  
|**Width**|列の幅は、CHAR または LONGCHAR 列に対して変更できます。 **テーブル**リストで選択した項目の書式が、このダイアログ ボックスで以前に定義されていない場合、幅は既定値の 1 になります。<br /><br /> その他のデータ型の場合、幅コントロールは無効になり、値は表示されません。|
