---
title: INDEX コマンド |マイクロソフトドキュメント
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- index command [ODBC]
ms.assetid: 694e8cf5-2f69-4001-9c1e-b735a4da3aff
author: David-Engel
ms.author: v-daenge
ms.openlocfilehash: bcb30a49cb9f11ddd4c61621116aa4bd8ddcf186
ms.sourcegitcommit: ce94c2ad7a50945481172782c270b5b0206e61de
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/14/2020
ms.locfileid: "81300032"
---
# <a name="index-command"></a>INDEX コマンド
テーブル レコードを表示および論理順序でアクセスするためのインデックス ファイルを作成します。  
  
## <a name="syntax"></a>構文  
  
```  
  
INDEX ON eExpression TO IDXFileName | TAG TagName [OF CDXFileName]  
   [FOR lExpression]  
   [COMPACT]  
   [ASCENDING | DESCENDING]  
   [UNIQUE | CANDIDATE]  
   [ADDITIVE]  
```  
  
## <a name="arguments"></a>引数  
 *e 式*  
 現在のテーブルのフィールドの名前を含めることができるインデックス式を指定します。 インデックス式に基づくインデックス キーは、テーブル内の各レコードのインデックス ファイルに作成されます。 Visual FoxPro では、これらのキーを使用してテーブル内のレコードを表示およびアクセスします。  
  
> [!NOTE]  
>  eExpression は*eExpression*、推奨されませんが、メモリ変数、配列要素、または別の作業領域のテーブルのフィールド式またはフィールド式を使用することもできます。 メモ型フィールドはインデックス ファイル式内で単独で使用することはできません。これらの文字は、他の文字式と組み合わせる必要があります。 存在しない、または見つからない変数またはフィールドを含むインデックスにアクセスすると、Visual FoxPro はエラー メッセージを生成します。  
  
 長さが異なるキーを使用してインデックスを作成しようとすると、キーにスペースが埋め込まれます。 可変長インデックス キーは、Visual FoxPro ではサポートされていません。  
  
 長さゼロのインデックスキーを作成できます。 たとえば、インデックス式が空のメモ型フィールドのサブ文字列である場合、長さゼロのインデックスキーが作成されます。 長さがゼロのインデックス キーを指定すると、エラー メッセージが生成されます。 Visual FoxPro は、インデックスを作成するときに、テーブルの最初のレコードのフィールドを評価します。 フィールドが空の場合、長さが 0 のインデックス キーを使用しないように、最初のレコードのフィールドに一時データを入力する必要があります。  
  
 *IDX ファイル名へ*  
 idx インデックス ファイルを作成します。 インデックス ファイルには、既定の拡張子 .idx が付けられます。  
  
 *タグタグ名*[OF *CDX ファイル名*]  
 複合インデックス ファイルを作成します。 複合インデックスファイルは、任意の数の個別のタグ(インデックスエントリ)で構成される単一のインデックスファイルです。 各タグは、その一意のタグ名で識別されます。 タグ名は、文字またはアンダースコアで始まる必要があり、最大 10 文字、数字、またはアンダースコアの任意の組み合わせで構成できます。 複合インデックス ファイル内のタグの数は、使用可能なメモリとディスク領域によってのみ制限されます。  
  
 複数エントリの複合インデックス ファイルは常にコンパクトです。 複合インデックスファイルを作成する際に、COMPACT を含める必要はありません。 複合インデックス ファイルの名前には、.cdx 拡張子が付きます。  
  
 複合インデックス ファイルは、構造ファイルと非構造ファイルの 2 種類を作成できます。  
  
 **構造複合インデックス ファイル**オプションの OF *CDXFileName*句を除外して、TAG*タグ名*を使用して構造複合インデックス ファイルを作成できます。 構造複合インデックス ファイルは、常にテーブルと同じベース名を持ち、テーブルを開くと自動的に開かれます。  
  
 **非構造複合インデックス ファイル**タグ*名*の後に OF *CDX ファイル名*を含めることで、非構造複合インデックス ファイルを作成できます。 構造複合インデックス ファイルとは異なり、非構造複合インデックス ファイルは、USE で INDEX 句を使用して明示的に開く必要があります。  
  
 複合インデックス ファイルが既に作成されて開かれている場合は、TAG *TagName*を指定して INDEX を発行すると、複合インデックス ファイルにタグが追加されます。  
  
 を*表す式*  
 フィルター式*lExpression*を満たすレコードだけが表示およびアクセスに使用できる条件を指定します。インデックス キーは、フィルター式に一致するレコードのためだけに、インデックス ファイルに作成されます。  
  
 ビジュアルフォックスプロラッシュモア技術は、インデックスを最適化します.*lExpression*が最適化可能な式である場合は、FOR *lExpression*コマンド。 最適なパフォーマンスを得るため、FOR 句で最適化可能な式を使用してください。  
  
 コンパクト  
 コンパクトな .idx ファイルを作成します。  
  
 昇順  
 cdx ファイルの昇順を指定します。 既定では、.cdx タグは昇順で作成されます。 (インデックス ファイルの順序を通知する ASCENDING を含めることができます)。テーブルは、降順を含めることによって逆の順序でインデックスを作成できます。  
  
 降順  
 cdx ファイルの降順を指定します。 idx インデックス ファイルを作成するときに降順を含むすることはできません。  
  
 UNIQUE  
 特定のインデックス キー値で最初に検出されたレコードだけを .idx ファイルまたは .cdx タグに含めるかどうかを指定します。 UNIQUE を使用して、重複レコードの表示や、重複レコードへのアクセスを防止できます。 重複するインデックス キーを使用して追加されたすべてのレコードは、インデックス ファイルから除外されます。 INDEX の UNIQUE オプションを使用することは、INDEX または REINDEX を発行する前に SET UNIQUE ON を実行することと同じです。  
  
 UNIQUE インデックスまたはインデックス タグがアクティブで、重複レコードがそのインデックス キーを変更する方法で変更されると、インデックスまたはインデックス タグが更新されます。 ただし、元のインデックス キーを持つ次の重複レコードは、REINDEX を使用してファイルのインデックスを再作成するまで、アクセスまたは表示できません。  
  
 候補  
 候補構造インデックス タグを作成します。 CANDIDATE キーワードは、構造インデックス タグを作成する場合にのみ含めることができます。それ以外の場合は、エラー メッセージが生成されます。  
  
 候補インデックス タグは、インデックス式*eExpression*で指定されたフィールドまたはフィールドの組み合わせで、重複する値を防ぎます。 *候補*という用語は、インデックスの種類を指します。候補インデックスは重複する値を防ぐため、プライマリ インデックスとして「候補」として修飾します。  
  
 重複する値が既に含まれているフィールドまたはフィールドの組み合わせに対して候補インデックス タグを作成すると、Visual FoxPro エラーが生成されます。  
  
 添加 物  
 以前に開いたインデックス ファイルを開いたままにします。 INDEX を使用してテーブルのインデックス ファイルを作成するときに ADDITIVE 句を省略すると、以前に開いたインデックス ファイル (構造複合インデックスを除く) はすべて閉じられます。  
  
## <a name="remarks"></a>解説  
 インデックス ファイルを持つテーブルのレコードは、インデックス式で指定された順序で表示およびアクセスされます。 テーブル内のレコードの物理的な順序は、インデックス ファイルによって変更されません。  
  
## <a name="index-types"></a>インデックスの種類  
 Visual FoxPro では、次の 2 種類のインデックス ファイルを作成できます。  
  
-   タグと呼ばれる複数のインデックス エントリを含む複合 .cdx インデックス ファイル  
  
-   1 つのインデックス エントリを含む .idx インデックス ファイル  
  
 また、構造複合インデックス ファイルを作成して、テーブルと共に自動的に開くことができます。  
  
> [!NOTE]  
>  構造複合インデックス ファイルは、テーブルを開いたときに自動的に開かれるため、推奨インデックス タイプです。  
  
 COMPACT を含めるので、コンパクトな .idx インデックス ファイルを作成します。 複合インデックス ファイルは常にコンパクトです。  
  
## <a name="index-order-and-updating"></a>インデックスの順序と更新  
 テーブルの表示またはアクセスの順序は、1 つのインデックス ファイル (マスター インデックス ファイル) またはタグ (マスター タグ) のみ制御します。 特定のコマンド (SEEK など) は、マスター索引ファイルまたはタグを使用してレコードを検索します。 ただし、開いているすべての .idx および .cdx インデックス ファイルは、テーブルに変更が加えられた時点で更新されます。  
  
## <a name="user-defined-functions"></a>ユーザー定義関数  
 インデックス式にはユーザー定義関数を含めることができますが、インデックス式ではユーザー定義関数を使用しないでください。 インデックス式のユーザー定義関数は、インデックスの作成または更新にかかる時間を増加させます。 また、ユーザー定義関数を索引式に使用する場合、索引の更新が行われない場合もあります。  
  
 インデックス式でユーザー定義関数を使用する場合、Visual FoxPro はユーザー定義関数を見つけることができる必要があります。 Visual FoxPro がインデックスを作成すると、インデックス式はインデックス ファイルに保存されますが、ユーザー定義関数への参照のみがインデックス式に含まれます。  
  
## <a name="see-also"></a>参照  
 [テーブルの変更 - SQL コマンド](../../odbc/microsoft/alter-table-sql-command.md)   
 [タグ削除コマンド](../../odbc/microsoft/delete-tag-command.md)   
 [セット・コレート・コマンド](../../odbc/microsoft/set-collate-command.md)   
 [SET UNIQUE コマンド](../../odbc/microsoft/set-unique-command.md)
