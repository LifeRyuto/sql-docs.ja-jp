---
title: テーブルの変更 - SQL コマンド |マイクロソフトドキュメント
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- alter table [ODBC]
ms.assetid: 3a01a291-f4d9-43bc-a725-5a95546ff364
author: David-Engel
ms.author: v-daenge
ms.openlocfilehash: 587d721522503f9b392bb8be7433850fd7449efb
ms.sourcegitcommit: ce94c2ad7a50945481172782c270b5b0206e61de
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/14/2020
ms.locfileid: "81304713"
---
# <a name="alter-table---sql-command"></a>ALTER TABLE - SQL コマンド
プログラムによってテーブルの構造を変更します。  
  
## <a name="syntax"></a>構文  
  
```  
  
ALTER TABLE TableName1  
   ADD | ALTER [COLUMN] FieldName1  
      FieldType [(nFieldWidth [, nPrecision])]  
      [NULL | NOT NULL]  
      [CHECK lExpression1 [ERROR cMessageText1]]  
      [DEFAULT eExpression1]  
      [PRIMARY KEY | UNIQUE]  
      [REFERENCES TableName2 [TAG TagName1]]  
      [NOCPTRANS]  
 - Or -  
ALTER TABLE TableName1  
   ALTER [COLUMN] FieldName2  
      [NULL | NOT NULL]  
      [SET DEFAULT eExpression2]  
      [SET CHECK lExpression2 [ERROR cMessageText2]]  
      [DROP DEFAULT]  
      [DROP CHECK]  
 - Or -  
ALTER TABLE TableName1  
   [DROP [COLUMN] FieldName3]  
   [SET CHECK lExpression3 [ERROR cMessageText3]]  
   [DROP CHECK]  
   [ADD PRIMARY KEY eExpression3 TAG TagName2]  
   [DROP PRIMARY KEY]  
   [ADD UNIQUE eExpression4 [TAG TagName3]]  
   [DROP UNIQUE TAG TagName4]  
   [ADD FOREIGN KEY [eExpression5] TAG TagName4  
      REFERENCES TableName2 [TAG TagName5]]  
   [DROP FOREIGN KEY TAG TagName6 [SAVE]]  
   [RENAME COLUMN FieldName4 TO FieldName5]  
   [NOVALIDATE]  
```  
  
## <a name="arguments"></a>引数  
 *テーブル名1*  
 構造が変更されるテーブルの名前を指定します。  
  
 [列]*フィールド名 1 を追加します。*  
 追加するフィールドの名前を指定します。  
  
 フィールド*名*1 を変更する [列]  
 変更する既存のフィールドの名前を指定します。  
  
 *フィールドタイプ* *[(n フィールド幅**,nPrecision])*  
 新しいフィールドまたは変更されたフィールドのフィールドの種類、フィールドの幅、およびフィールドの精度 (小数点以下の桁数) を指定します。  
  
 *FieldType*はフィールドの[データ型](../../odbc/microsoft/visual-foxpro-field-data-types.md)を示す 1 文字です。 一部のフィールド データ型では *、nFieldWidth*または*nPrecision*またはその両方を指定する必要があります。  
  
 *Nフィールド幅*と*nPrecision*は、D、G、I、L、M、P、T、および Y 型では無視されます。 既定では *、nPrecision*が B、F、または N 型に含まれていない場合、*ゼロ*(小数点以下の桁数なし) です。  
  
 NULL &#124; NOT NULL  
 フィールド内の NULL 値を許可または禁止します。  
  
 NULL と NOT NULL を省略すると、現在の SET NULL の設定によって、フィールドに NULL 値を使用できるかどうかが決まります。 ただし、NULL と NOT NULL を省略し、主キーまたは UNIQUE 句を含める場合、SET NULL の現在の設定は無視され、フィールドは既定では NULL ではありません。  
  
 チェック*l 式1*  
 フィールドの入力規則を指定します。 *lExpression1*は論理式に評価する必要があり、ユーザー定義関数またはストアド プロシージャを指定できます。 空白のレコードが追加されると、入力規則がチェックされます。 入力規則で追加されたレコードの空白フィールド値が許可されていない場合、エラーが生成されます。  
  
 エラー*メッセージテキスト1*  
 フィールドの入力規則でエラーが生成されたときに表示されるエラー メッセージを指定します。  
  
 既定*の e 式1*  
 フィールドの既定値を指定します。 *eExpression1*のデータ型は、フィールドのデータ型と同じである必要があります。  
  
 PRIMARY KEY  
 プライマリ インデックス タグを作成します。 インデックス タグの名前はフィールドと同じです。  
  
 UNIQUE  
 フィールドと同じ名前の候補インデックス タグを作成します。  
  
> [!NOTE]  
>  候補索引 (ALTER TABLE または CREATE TABLE で ANSI 互換のために提供される UNIQUE オプションを組み込んだ場合に作成される) は、INDEX コマンドの UNIQUE オプションを使用して作成された索引とは異なります。 INDEX コマンドで UNIQUE を使用して作成されたインデックスでは、重複するインデックス キーが許可されます。候補インデックスでは、重複するインデックス キーは許可されません。  
  
 NULL 値および重複レコードは、プライマリインデックスまたは候補インデックスに使用されるフィールドでは許可されません。  
  
 ADD COLUMN を使用して新しいフィールドを作成する場合、Null 値をサポートするフィールドのプライマリインデックスまたは候補インデックスを作成しても、Visual FoxPro はエラーを生成しません。 ただし、プライマリインデックスまたは候補インデックスに使用されるフィールドに null または重複する値を入力しようとすると、Visual FoxPro エラーが生成されます。  
  
 既存のフィールドを変更する場合、プライマリまたは候補のインデックス式がテーブル内のフィールドで構成されている場合、Visual FoxPro は、フィールドに NULL 値または重複レコードが含まれているかどうかをチェックします。 その場合、Visual FoxPro はエラーを生成し、テーブルは変更されません。  
  
 参照*テーブル名2*タグ*タグ名1*  
 永続的な関係が確立される親テーブルを指定します。 TAG *TagName1*は、リレーションシップの基になる親テーブルのインデックス タグを指定します。 インデックス タグ名には、最大 10 文字を使用できます。  
  
 ノCPトランス  
 文字フィールドとメモ型フィールドの別のコード ページへの変換を禁止します。 表が別のコード・ページに変換される場合、NOCPTRANS が指定されているフィールドは変換されません。 NOCPTRANS は、文字フィールドおよびメモ・フィールドに対してのみ指定できます。  
  
 次の例では、2 つの文字フィールドと 2 つのメモ型フィールドを含む mytable という名前のテーブルを作成します。 2 番目の文字フィールド char2 と 2 番目のメモフィールド memo2 には、変換を防止するために NOCPTRANS が含まれています。  
  
```  
CREATE TABLE mytable (char1 C(10), char2 C(10) NOCPTRANS,;  
   memo1 M, memo2 M NOCPTRANS)  
```  
  
 フィールド*名 2*を変更する [列]  
 変更する既存のフィールドの名前を指定します。  
  
 既定*の e 式2 を設定します*  
 既存のフィールドの新しい既定値を指定します。 *eExpression2*のデータ型は、フィールドのデータ型と同じである必要があります。  
  
 セットチェック*l式2*  
 既存のフィールドに対する新しい入力規則を指定します。 *lExpression2*は論理式に評価する必要があり、ユーザー定義関数またはストアド プロシージャである場合があります。  
  
 エラー*メッセージテキスト2*  
 フィールドの入力規則でエラーが生成されたときに表示されるエラー メッセージを指定します。 このメッセージは、[参照] ウィンドウまたは [編集] ウィンドウ内でデータが変更された場合にのみ表示されます。  
  
 DROP DEFAULT  
 既存のフィールドの既定値を削除します。  
  
 ドロップチェック  
 既存のフィールドの入力規則を削除します。  
  
 ドロップ [列]*フィールド名3*  
 テーブルから削除するフィールドを指定します。 テーブルからフィールドを削除すると、フィールドの既定値の設定とフィールドの入力規則も削除されます。  
  
 インデックス キーまたはトリガ式がフィールドを参照している場合、フィールドが削除されると式は無効になります。 この場合、フィールドが削除された場合はエラーは生成されませんが、無効なインデックス キーまたはトリガ式は実行時にエラーを生成します。  
  
 セットチェック*l式3*  
 テーブルの入力規則を指定します。 *lExpression3*は論理式に評価する必要があり、ユーザー定義関数またはストアド プロシージャである場合があります。  
  
 エラー*メッセージテキスト3*  
 テーブルの入力規則でエラーが生成されたときに表示されるエラー メッセージを指定します。 このメッセージは、[参照] ウィンドウまたは [編集] ウィンドウ内でデータが変更された場合にのみ表示されます。  
  
 ドロップチェック  
 テーブルの入力規則を削除します。  
  
 主キー*の eExpression3*タグ*名 2 を追加します。*  
 テーブルにプライマリ インデックスを追加します。 *eExpression3 は*、プライマリ インデックス キー式を指定し *、TagName2*はプライマリ インデックス タグの名前を指定します。 インデックス タグ名には、最大 10 文字を使用できます。 TAG *TagName2*が省略され *、eExpression3*が単一のフィールドである場合、プライマリ インデックス タグは*eExpression3*で指定されたフィールドと同じ名前になります。  
  
 主キーの削除  
 プライマリ インデックスとそのインデックス タグを削除します。 テーブルには 1 つの主キーしか指定できないため、主キーの名前を指定する必要はありません。 プライマリ インデックスを削除すると、主キーに基づく永続的な関係も削除されます。  
  
 一意*な式を追加する4*[*タグ名3]*  
 候補インデックスをテーブルに追加します。 *eExpression4*は候補インデックス キー式を指定し *、TagName3 は*候補インデックス タグの名前を指定します。 インデックス タグ名には、最大 10 文字を使用できます。 TAG *TagName3*を省略し *、eExpression4*が単一のフィールドの場合、候補インデックス タグの名前は*eExpression4*で指定されたフィールドと同じになります。  
  
 ドロップユニークタグ*タグ名4*  
 候補インデックスとそのインデックス タグを削除します。 テーブルには複数の候補キーを指定できるため、候補インデックス タグの名前を指定する必要があります。  
  
 外部キーの追加 [ *eExpression5*]*タグ名4*  
 テーブルに外部 (非プライマリ) インデックスを追加します。 *eExpression5 は*外部インデックス キー式を指定し *、TagName4*は外部インデックス タグの名前を指定します。 インデックス タグ名には、最大 10 文字を使用できます。  
  
 参照*テーブル名2*[*タグ名5]*  
 永続的な関係が確立される親テーブルを指定します。 親テーブルの既存のインデックス タグに基づいてリレーションシップを確立するには *、TAG TagName5*を含めます。 インデックス タグ名には、最大 10 文字を使用できます。 TAG *TagName5*を省略すると、親テーブルのプライマリ インデックス タグを使用してリレーションシップが確立されます。  
  
 外部キー*タグ名を*削除する [保存]  
 インデックス タグが*TagName6*である外部キーを削除します。 SAVE を省略すると、構造インデックスからインデックス タグが削除されます。 構造インデックスからインデックスタグが削除されないようにするには、SAVE を含めます。  
  
 列*フィールド名4*から*フィールド名5*に名前変更  
 テーブル内のフィールドの名前を変更できます。 *FieldName4*は、名前を変更するフィールドの名前を指定します。 *FieldName5 は*、フィールドの新しい名前を指定します。  
  
> [!CAUTION]  
>  インデックス式、フィールドとテーブルの入力規則、コマンド、および関数が元のフィールド名を参照する可能性があるため、テーブルフィールドの名前を変更する場合は注意が必要です。  
  
 無効にする  
 テーブルの構造に変更を加えることを Visual FoxPro に許可することを指定します。これらの変更は、テーブル内のデータの整合性に違反する可能性があります。 既定では、テーブル内のデータの整合性に違反する変更を変更できないようにします。 このデフォルトの動作をオーバーライドするには、NOVALIDATE を含めます。  
  
## <a name="remarks"></a>解説  
 ALTER TABLE を使用すると、データベースに追加されていないテーブルの構造を変更できます。 ただし、空きテーブルを変更するときに、デフォルト、外部キー、主キー、参照、または SET 句を含めると、Visual FoxPro エラーが生成されます。  
  
 ALTER TABLE は、新しいテーブル ヘッダーを作成し、テーブル ヘッダーにレコードを追加することによってテーブルを再構築できます。 たとえば、フィールドの型や幅を変更すると、テーブルが再構築される場合があります。  
  
 テーブルが再構築されると、型または幅が変更されたフィールドに対してフィールドの入力規則が実行されます。 テーブル内の任意のフィールドのタイプまたは幅を変更すると、テーブルルールが実行されます。  
  
 レコードを持つテーブルのフィールドまたはテーブルの入力規則を変更すると、Visual FoxPro は既存のデータに対して新しいフィールドまたはテーブルの検証規則をテストし、フィールドまたはテーブルの入力規則の最初の出現またはトリガー違反に関する警告を発行します。  
  
 変更するテーブルがデータベース内にある場合、ALTER TABLE - SQL はデータベースを排他的に使用する必要があります。 排他的に使用するデータベースを開くには、データベースを開く中に EXCLUSIVE を含めます。  
  
## <a name="see-also"></a>参照  
 [テーブルの作成 - SQL コマンド](../../odbc/microsoft/create-table-sql-command.md)   
 [INDEX コマンド](../../odbc/microsoft/index-command.md)
